"use strict";(self.webpackChunkwellcast=self.webpackChunkwellcast||[]).push([[373],{62312:function(e,t,n){var r=n(25108);function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a(e,t){var n=e[t];if(n)return n;var r={};return e[t]=r,r}function i(e,t){return new(e.bind.apply(e,[e].concat(t)))}let u;var s=globalThis;class l{constructor(e,t,n){this._css=e,this.relativeToElement=t,this.escape=n}get css(){return this.escape?p.escapeSelector(this._css):this._css}get className(){return this._css.substr(1)}get id(){return this.className()}contains(e){for(let t of this)if(t.contains(e))return!0;return!1}get length(){return this.selectMatches().length}[Symbol.iterator](){return this.selectMatches()[Symbol.iterator]()}selectMatches(){return p.getRootNode(this.relativeToElement).querySelectorAll(this.css)}}var c=function(){var e={"+":"PLUS","-":"MINUS","*":"MULTIPLY","/":"DIVIDE",".":"PERIOD","..":"ELLIPSIS","\\":"BACKSLASH",":":"COLON","%":"PERCENT","|":"PIPE","!":"EXCLAMATION","?":"QUESTION","#":"POUND","&":"AMPERSAND",$:"DOLLAR",";":"SEMI",",":"COMMA","(":"L_PAREN",")":"R_PAREN","<":"L_ANG",">":"R_ANG","<=":"LTE_ANG",">=":"GTE_ANG","==":"EQ","===":"EQQ","!=":"NEQ","!==":"NEQQ","{":"L_BRACE","}":"R_BRACE","[":"L_BRACKET","]":"R_BRACKET","=":"EQUALS"};function t(e){return i(e)||a(e)||"-"===e||"_"===e||":"===e}function n(e){return i(e)||a(e)||"-"===e||"_"===e||":"===e}function r(e){return" "===e||"\t"===e||o(e)}function o(e){return"\r"===e||"\n"===e}function a(e){return e>="0"&&e<="9"}function i(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function u(e,t){return"_"===e||"$"===e}function s(e,t,n){o();var r=null;function o(){for(;"WHITESPACE"===m(0,!0).type;)t.push(e.shift())}function a(e,t){f.raiseParseError(e,t)}function i(e){if(p()&&p().op&&p().value===e)return l()}function u(e,t,n,r){if(p()&&p().type&&[e,t,n,r].indexOf(p().type)>=0)return l()}function s(e,t){if(-1===d.indexOf(e))return t=t||"IDENTIFIER",p()&&p().value===e&&p().type===t?l():void 0}function l(){var n=e.shift();return t.push(n),r=n,o(),n}function c(n,r){for(var a=[],i=m(0,!0);!(null!=r&&i.type===r||null!=n&&i.value===n||"EOF"===i.type);){var u=e.shift();t.push(u),a.push(i),i=m(0,!0)}return o(),a}function m(t,n){var r,o=0;do{if(!n)for(;e[o]&&"WHITESPACE"===e[o].type;)o++;r=e[o],t--,o++}while(t>-1);return r||{type:"EOF",value:"<<<EOF>>>"}}function p(){return m(0)}var d=[];return{pushFollow:function(e){d.push(e)},popFollow:function(){d.pop()},clearFollow:function(){var e=d;return d=[],e},restoreFollow:function(e){d=e},matchAnyToken:function(e,t,n){for(var r=0;r<arguments.length;r++){var o=arguments[r],a=s(o);if(a)return a}},matchAnyOpToken:function(e,t,n){for(var r=0;r<arguments.length;r++){var o=arguments[r],a=i(o);if(a)return a}},matchOpToken:i,requireOpToken:function(e){var t=i(e);if(t)return t;a(this,"Expected '"+e+"' but found '"+p().value+"'")},matchTokenType:u,requireTokenType:function(e,t,n,r){var o=u(e,t,n,r);if(o)return o;a(this,"Expected one of "+JSON.stringify([e,t,n]))},consumeToken:l,peekToken:function(t,n,r){return e[n]&&e[n].value===t&&e[n].type===r},matchToken:s,requireToken:function(e,t){var n=s(e,t);if(n)return n;a(this,"Expected '"+e+"' but found '"+p().value+"'")},list:e,consumed:t,source:n,hasMore:function(){return e.length>0},currentToken:p,lastMatch:function(){return r},token:m,consumeUntil:c,consumeUntilWhitespace:function(){return c(null,"WHITESPACE")},lastWhitespace:function(){return t[t.length-1]&&"WHITESPACE"===t[t.length-1].type?t[t.length-1].value:""},sourceFor:function(){return n.substring(this.startToken.start,this.endToken.end)},lineFor:function(){return n.split("\n")[this.startToken.line-1]}}}function l(e){if(e.length>0){var t=e[e.length-1];if("IDENTIFIER"===t.type||"CLASS_REF"===t.type||"ID_REF"===t.type)return!1;if(t.op&&(">"===t.value||")"===t.value))return!1}return!0}return{tokenize:function(c,f){var m,p=[],d=c,h=0,v=0,E=1,T="<START>",y=0;function k(){return f&&0===y}for(;h<d.length;)if("-"!==O()||"-"!==A()||!r(F())&&""!==F())if(r(O()))p.push(D());else if(M()||"."!==O()||!i(A())&&"{"!==A())if(M()||"#"!==O()||!i(A())&&"{"!==A())if("["===O()&&"@"===A())p.push(q());else if("@"===O())p.push(w());else if("*"===O()&&i(A()))p.push(N());else if(i(O())||!k()&&u(O()))p.push(I());else if(a(O()))p.push(C());else if(k()||'"'!==O()&&"`"!==O())if(k()||"'"!==O()){if(e[O()])"$"===T&&"{"===O()&&y++,"}"===O()&&y--,p.push(R());else if(k()||"`"===(m=O())||"^"===m)p.push(g("RESERVED",P()));else if(h<d.length)throw Error("Unknown token: "+O()+" ")}else l(p)?p.push(L()):p.push(R());else p.push(L());else p.push(S());else p.push(b());else x();return s(p,[],d);function g(e,t){return{type:e,value:t,start:h,end:h+1,column:v,line:E}}function x(){for(;O()&&!o(O());)P();P()}function b(){var e=g("CLASS_REF"),n=P();if("{"===O()){for(e.template=!0,n+=P();O()&&"}"!==O();)n+=P();if("}"!==O())throw Error("Unterminated class reference");n+=P()}else for(;t(O());)n+=P();return e.value=n,e.end=h,e}function q(){for(var e=g("ATTRIBUTE_REF"),t=P();h<d.length&&"]"!==O();)t+=P();return"]"===O()&&(t+=P()),e.value=t,e.end=h,e}function w(){for(var e=g("ATTRIBUTE_REF"),t=P();n(O());)t+=P();return e.value=t,e.end=h,e}function N(){for(var e=g("STYLE_REF"),t=P();i(O())||"-"===O();)t+=P();return e.value=t,e.end=h,e}function S(){var e=g("ID_REF"),t=P();if("{"===O()){for(e.template=!0,t+=P();O()&&"}"!==O();)t+=P();if("}"!==O())throw Error("Unterminated id reference");P()}else for(;n(O());)t+=P();return e.value=t,e.end=h,e}function I(){for(var e=g("IDENTIFIER"),t=P();i(O())||a(O())||u(O());)t+=P();return"!"===O()&&"beep"===t&&(t+=P()),e.value=t,e.end=h,e}function C(){for(var e=g("NUMBER"),t=P();a(O());)t+=P();for("."===O()&&a(A())&&(t+=P());a(O());)t+=P();return e.value=t,e.end=h,e}function R(){for(var t=(r=void 0,(r=g(void 0,void 0)).op=!0,r),n=P();O()&&e[n+O()];)n+=P();var r;return t.type=e[n],t.value=n,t.end=h,t}function L(){for(var e,t=g("STRING"),n=P(),r="";O()&&O()!==n;)if("\\"===O()){P();let e=P();r+="b"===e?"\b":"f"===e?"\f":"n"===e?"\n":"r"===e?"\r":"t"===e?"\t":"v"===e?"\v":e}else r+=P();if(O()!==n)throw Error("Unterminated string at [Line: "+(e=t).line+", Column: "+e.column+"]");return P(),t.value=r,t.end=h,t.template="`"===n,t}function O(){return d.charAt(h)}function A(){return d.charAt(h+1)}function F(){return d.charAt(h+2)}function P(){return T=O(),h++,v++,T}function M(){return i(T)||a(T)||")"===T||'"'===T||"'"===T||"`"===T||"}"===T||"]"===T}function D(){for(var e=g("WHITESPACE"),t="";O()&&r(O());)o(O())&&(v=0,E++),t+=P();return e.value=t,e.end=h,e}},makeTokensObject:s}}(),f=function(){var e={},t={},n={},r=[],o=[];function a(e,t,n){e.startToken=t,e.sourceFor=n.sourceFor,e.lineFor=n.lineFor,e.programSource=n.source}function i(t,n,r){var o=e[t];if(o){var i=n.currentToken(),u=o(f,p,n,r);if(u)for(a(u,i,n),u.endToken=u.endToken||n.lastMatch(),r=u.root;null!=r;)a(r,i,n),r=r.root;return u}}function u(e,t,n,r){var o=i(e,t,r);return o||c(t,n||"Expected "+e),o}function s(e,t){for(var n=0;n<e.length;n++){var r=i(e[n],t);if(r)return r}}function l(t,n){e[t]=n}function c(e,t){t=(t||"Unexpected Token : "+e.currentToken().value)+"\n\n"+function(e){var t=e.currentToken(),n=e.source.split("\n"),r=n[t&&t.line?t.line-1:n.length-1];return r+"\n"+" ".repeat(t&&t.line?t.column:r.length-1)+"^^\n\n"}(e);var n=new Error(t);throw n.tokens=e,n}function m(e){return t[e.value]}function d(e){return n[e.value]}return l("feature",(function(e,t,r){if(r.matchOpToken("(")){var o=e.requireElement("feature",r);return r.requireOpToken(")"),o}var a=n[r.currentToken().value];if(a)return a(e,t,r)})),l("command",(function(e,n,r){if(r.matchOpToken("(")){const t=e.requireElement("command",r);return r.requireOpToken(")"),t}var o=t[r.currentToken().value];let a;return o?a=o(e,n,r):"IDENTIFIER"===r.currentToken().type&&(a=e.parseElement("pseudoCommand",r)),a?e.parseElement("indirectStatement",r,a):a})),l("commandList",(function(e,t,n){var r=e.parseElement("command",n);if(r){n.matchToken("then");const t=e.parseElement("commandList",n);return t&&(r.next=t),r}})),l("leaf",(function(e,t,n){var o=s(r,n);return null==o?i("symbol",n):o})),l("indirectExpression",(function(e,t,n,r){for(var a=0;a<o.length;a++){var i=o[a];r.endToken=n.lastMatch();var u=e.parseElement(i,n,r);if(u)return u}return r})),l("indirectStatement",(function(e,t,n,r){if(n.matchToken("unless")){r.endToken=n.lastMatch();var o={type:"unlessStatementModifier",args:[e.requireElement("expression",n)],op:function(e,t){return t?this.next:r},execute:function(e){return t.unifiedExec(this,e)}};return r.parent=o,o}return r})),l("primaryExpression",(function(e,t,n){var r=e.parseElement("leaf",n);if(r)return e.parseElement("indirectExpression",n,r);e.raiseParseError(n,"Unexpected value: "+n.currentToken().value)})),{setParent:function e(t,n){"object"==typeof t&&(t.parent=n,"object"==typeof n&&(n.children=n.children||new Set,n.children.add(t)),e(t.next,n))},requireElement:u,parseElement:i,featureStart:d,commandStart:m,commandBoundary:function(e){return!("end"!=e.value&&"then"!=e.value&&"else"!=e.value&&"otherwise"!=e.value&&")"!=e.value&&!m(e)&&!d(e)&&"EOF"!=e.type)},parseAnyOf:s,parseHyperScript:function(e){var t=i("hyperscript",e);if(e.hasMore()&&c(e),t)return t},raiseParseError:c,addGrammarElement:l,addCommand:function(n,r){var o=n+"Command",a=function(e,t,n){const a=r(e,t,n);if(a)return a.type=o,a.execute=function(e){return e.meta.command=a,t.unifiedExec(this,e)},a};e[o]=a,t[n]=a},addFeature:function(t,r){var o=t+"Feature",a=function(e,n,a){var i=r(e,n,a);if(i)return i.isFeature=!0,i.keyword=t,i.type=o,i};e[o]=a,n[t]=a},addLeafExpression:function(e,t){r.push(e),l(e,t)},addIndirectExpression:function(e,t){o.push(e),l(e,t)},parseStringTemplate:function(e){var t=[""];do{if(t.push(e.lastWhitespace()),"$"===e.currentToken().value){e.consumeToken();var n=e.matchOpToken("{");t.push(u("expression",e)),n&&e.requireOpToken("}"),t.push("")}else if("\\"===e.currentToken().value)e.consumeToken(),e.consumeToken();else{var r=e.consumeToken();t[t.length-1]+=r?r.value:""}}while(e.hasMore());return t.push(e.lastWhitespace()),t},ensureTerminated:function(e){for(var t={type:"implicitReturn",op:function(e){return e.meta.returned=!0,e.meta.resolve&&e.meta.resolve(),p.HALT},execute:function(e){}},n=e;n.next;)n=n.next;n.next=t}}}(),m={dynamicResolvers:[function(e,t){if("Fixed"===e)return Number(t).toFixed();if(0===e.indexOf("Fixed:")){let n=e.split(":")[1];return Number(t).toFixed(parseInt(n))}}],String:function(e){return e.toString?e.toString():""+e},Int:function(e){return parseInt(e)},Float:function(e){return parseFloat(e)},Number:function(e){return Number(e)},Date:function(e){return new Date(e)},Array:function(e){return Array.from(e)},JSON:function(e){return JSON.stringify(e)},Object:function(e){return e instanceof String&&(e=e.toString()),"string"==typeof e?JSON.parse(e):o({},e)}},p=function(){function e(e,t){var n=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return n&&n.call(e,t)}function t(e,t,n,r){(n=n||{}).sender=r;var o=function(e,t){var n;return s.Event&&"function"==typeof s.Event?(n=new Event(e,{bubbles:!0,cancelable:!0})).detail=t:(n=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,t),n}(t,n);return e.dispatchEvent(o)}function n(e){return Array.isArray(e)||"undefined"!=typeof NodeList&&(e instanceof NodeList||e instanceof HTMLCollection)}function i(e){return e instanceof l||n(e)}function d(e,t){if(null==e);else if(function(e){return"object"==typeof e&&Symbol.iterator in e&&"function"==typeof e[Symbol.iterator]}(e))for(const n of e)t(n);else if(n(e))for(var r=0;r<e.length;r++)t(e[r]);else t(e)}function h(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.asyncWrapper&&(e[t]=n.value),Array.isArray(n))for(var r=0;r<n.length;r++){var o=n[r];o.asyncWrapper&&(n[r]=o.value)}}}var v={};function E(e,t){var n=[t],r=!1,o=!1;if(e.args)for(var a=0;a<e.args.length;a++){var i=e.args[a];if(null==i)n.push(null);else if(Array.isArray(i)){for(var u=[],s=0;s<i.length;s++){var l=i[s];(c=l?l.evaluate(t):null)&&(c.then?r=!0:c.asyncWrapper&&(o=!0)),u.push(c)}n.push(u)}else if(i.evaluate){var c;(c=i.evaluate(t))&&(c.then?r=!0:c.asyncWrapper&&(o=!0)),n.push(c)}else n.push(i)}return r?new Promise((function(t,r){n=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t.push(Promise.all(r)):t.push(r)}return t}(n),Promise.all(n).then((function(n){o&&h(n);try{var a=e.op.apply(e,n);t(a)}catch(e){r(e)}})).catch((function(e){r(e)}))})):(o&&h(n),e.op.apply(e,n))}let T=null;function y(){return null==T&&(T=u.config.attributes.replace(/ /g,"").split(",")),T}function k(e){for(var t=0;t<y().length;t++){var n=y()[t];if(e.hasAttribute&&e.hasAttribute(n))return e.getAttribute(n)}return e instanceof HTMLScriptElement&&"text/hyperscript"===e.type?e.innerText:null}var g=new WeakMap;function x(e){var t=g.get(e);return void 0===t&&g.set(e,t={}),t}function b(e,t){e&&(o(t,x(e)),b(e.parentElement,t))}function q(e,t,n,r){var o={meta:{parser:f,lexer:c,runtime:p,owner:e,feature:t,iterators:{}},me:n,event:r,target:r?r.target:null,detail:r?r.detail:null,sender:r&&r.detail?r.detail.sender:null,body:"document"in s?document.body:null};return o.meta.ctx=o,b(e,o),o}function w(e){var t=c.tokenize(e);if(f.commandStart(t.currentToken())){var n=f.requireElement("commandList",t);return t.hasMore()&&f.raiseParseError(t),f.ensureTerminated(n),n}if(f.featureStart(t.currentToken())){var r=f.requireElement("hyperscript",t);return t.hasMore()&&f.raiseParseError(t),r}var o=f.requireElement("expression",t);return t.hasMore()&&f.raiseParseError(t),o}function N(e,n){if(!e.closest||!e.closest(u.config.disableSelector)){var o=I(e);if(!o.initialized){var a=k(e);if(a)try{o.initialized=!0,o.script=a;var i=c.tokenize(a),s=f.parseHyperScript(i);if(!s)return;s.apply(n||e,e),setTimeout((function(){t(n||e,"load",{hyperscript:!0})}),1)}catch(n){p.triggerEvent(e,"exception",{error:n}),r.error("hyperscript errors were found on the following element:",e,"\n\n",n.message,n.stack)}}}}var S=new WeakMap;function I(e){var t=S.get(e);return void 0===t&&S.set(e,t={}),t}function C(e){var t=e.meta&&e.meta.owner;if(t){var n=I(t),r="elementScope";return e.meta.feature&&e.meta.feature.behavior&&(r=e.meta.feature.behavior+"Scope"),a(n,r)}return{}}function R(e,t,n){if(null!=e){var r=n(e,t);if(void 0!==r)return r;if(i(e)){var o=[];for(var a of e){var u=n(a,t);u&&o.push(u)}return o}}}return{typeCheck:function(e,t,n){return!(null!=e||!n)||Object.prototype.toString.call(e).slice(8,-1)===t},forEach:d,implicitLoop:function(e,t){if(i(e))for(const n of e)t(n);else t(e)},shouldAutoIterate:i,triggerEvent:t,matchesSelector:e,getScript:k,processNode:function(t){var n=p.getScriptSelector();e(t,n)&&N(t,t),t instanceof HTMLScriptElement&&"text/hyperscript"===t.type&&N(t,document.body),t.querySelectorAll&&d(t.querySelectorAll(n+", [type='text/hyperscript']"),(function(e){N(e,e instanceof HTMLScriptElement&&"text/hyperscript"===e.type?document.body:e)}))},evaluate:function(e,t,n){class r extends EventTarget{constructor(e){super(),this.module=e}toString(){return this.module.id}}var a="document"in s?s.document.body:new r(n&&n.module);t=o(q(a,null,a,null),t||{});var i=w(e);return i.execute?(i.execute(t),t.result):i.apply?(i.apply(a,a,n),x(a)):i.evaluate(t)},evaluateNoPromise:function(e,t){let n=e.evaluate(t);if(n.next)throw new Error(e.sourceFor()+" returned a Promise in a context that they are not allowed.");return n},parse:w,getScriptSelector:function(){return y().map((function(e){return"["+e+"]"})).join(", ")},resolveSymbol:function(e,t,n){if("me"===e||"my"===e||"I"===e)return t.me;if("it"===e||"its"===e)return t.result;if("you"===e||"your"===e||"yourself"===e)return t.beingTold;if("global"===n)return s[e];if("element"===n)return C(t)[e];if("local"===n)return t[e];if(t.meta&&t.meta.context){var r=t.meta.context[e];if(void 0!==r)return r}var o=t[e];return void 0!==o||void 0!==(o=C(t)[e])?o:s[e]},setSymbol:function(e,t,n,r){if("global"===n)s[e]=r;else if("element"===n)(o=C(t))[e]=r;else if("local"===n)t[e]=r;else{var o,a=t[e];void 0!==a?t[e]=r:void 0!==(a=(o=C(t))[e])?o[e]=r:t[e]=r}},makeContext:q,findNext:function e(t,n){if(t)return t.resolveNext?t.resolveNext(n):t.next?t.next:e(t.parent,n)},unifiedEval:E,convertValue:function(e,t){for(var n=m.dynamicResolvers,r=0;r<n.length;r++){var o=(0,n[r])(t,e);if(void 0!==o)return o}if(null==e)return null;var a=m[t];if(a)return a(e);throw"Unknown conversion : "+t},unifiedExec:function e(t,n){for(;;){try{var o=E(t,n)}catch(e){if(n.meta.handlingFinally)r.error(" Exception in finally block: ",e),o=v;else{if(p.registerHyperTrace(n,e),n.meta.errorHandler&&!n.meta.handlingError){n.meta.handlingError=!0,n[n.meta.errorSymbol]=e,t=n.meta.errorHandler;continue}n.meta.currentException=e,o=v}}if(null==o)return void r.error(t," did not return a next element to execute! context: ",n);if(o.then)return void o.then((function(t){e(t,n)})).catch((function(t){e({op:function(){throw t}},n)}));if(o===v){if(!n.meta.finallyHandler||n.meta.handlingFinally){if(n.meta.onHalt&&n.meta.onHalt(),n.meta.currentException){if(n.meta.reject)return void n.meta.reject(n.meta.currentException);throw n.meta.currentException}return}n.meta.handlingFinally=!0,t=n.meta.finallyHandler}else t=o}},resolveProperty:function(e,t){return R(e,t,((e,t)=>e[t]))},resolveAttribute:function(e,t){return R(e,t,((e,t)=>e.getAttribute&&e.getAttribute(t)))},resolveStyle:function(e,t){return R(e,t,((e,t)=>e.style&&e.style[t]))},resolveComputedStyle:function(e,t){return R(e,t,((e,t)=>getComputedStyle(e).getPropertyValue(t)))},assignToNamespace:function(e,t,n,r){let o;for(o="undefined"!=typeof document&&e===document.body?s:x(e);t.length>0;){var a=t.shift(),i=o[a];null==i&&(o[a]=i={}),o=i}o[n]=r},registerHyperTrace:function(e,t){for(var n=[],o=null;null!=e;)n.push(e),o=e,e=e.meta.caller;null==o.meta.traceMap&&(o.meta.traceMap=new Map),o.meta.traceMap.get(t)||o.meta.traceMap.set(t,{trace:n,print:function(e){(e=e||r.error)("hypertrace /// ");for(var t=0,o=0;o<n.length;o++)t=Math.max(t,n[o].meta.feature.displayName.length);for(o=0;o<n.length;o++){var a=n[o];e("  ->",a.meta.feature.displayName.padEnd(t+2),"-",a.meta.owner)}}})},getHyperTrace:function(e,t){for(var n=e;n.meta.caller;)n=n.meta.caller;if(n.meta.traceMap)return n.meta.traceMap.get(t,[])},getInternalData:I,getHyperscriptFeatures:x,escapeSelector:function(e){return e.replace(/:/g,(function(e){return"\\"+e}))},nullCheck:function(e,t){if(null==e)throw new Error("'"+t.sourceFor()+"' is null")},isEmpty:function(e){return null==e||0===e.length},doesExist:function(e){if(null==e)return!1;if(i(e))for(const t of e)return!0;return!1},getRootNode:function(e){if(e&&e instanceof Node){var t=e.getRootNode();if(t instanceof Document||t instanceof ShadowRoot)return t}return document},getEventQueueFor:function(e,t){let n=I(e);var r=n.eventQueues;null==r&&(r=new Map,n.eventQueues=r);var o=r.get(t);return null==o&&r.set(t,o={queue:[],executing:!1}),o},hyperscriptUrl:"document"in s?"file:///home/vian/codes/python/WellCast-django/node_modules/hyperscript.org/dist/_hyperscript_web.modern.js":null,HALT:v}}();{f.addLeafExpression("parenthesized",(function(e,t,n){if(n.matchOpToken("(")){var r=n.clearFollow();try{var o=e.requireElement("expression",n)}finally{n.restoreFollow(r)}return n.requireOpToken(")"),o}})),f.addLeafExpression("string",(function(e,t,n){var r=n.matchTokenType("STRING");if(r){var o,a=r.value;if(r.template){var i=c.tokenize(a,!0);o=e.parseStringTemplate(i)}else o=[];return{type:"string",token:r,args:o,op:function(e){for(var t="",n=1;n<arguments.length;n++){var r=arguments[n];void 0!==r&&(t+=r)}return t},evaluate:function(e){return 0===o.length?a:t.unifiedEval(this,e)}}}})),f.addGrammarElement("nakedString",(function(e,t,n){if(n.hasMore()){var r=n.consumeUntilWhitespace();return n.matchTokenType("WHITESPACE"),{type:"nakedString",tokens:r,evaluate:function(e){return r.map((function(e){return e.value})).join("")}}}})),f.addLeafExpression("number",(function(e,t,n){var r=n.matchTokenType("NUMBER");if(r){var o=r,a=parseFloat(r.value);return{type:"number",value:a,numberToken:o,evaluate:function(){return a}}}})),f.addLeafExpression("idRef",(function(e,t,n){var r=n.matchTokenType("ID_REF");if(r){if(r.template){var o=r.value.substr(2,r.value.length-2),a=c.tokenize(o);return{type:"idRefTemplate",args:[e.requireElement("expression",a)],op:function(e,n){return t.getRootNode(e.me).getElementById(n)},evaluate:function(e){return t.unifiedEval(this,e)}}}{const e=r.value.substr(1);return{type:"idRef",css:r.value,value:e,evaluate:function(n){return t.getRootNode(n.me).getElementById(e)}}}}})),f.addLeafExpression("classRef",(function(e,t,n){var r=n.matchTokenType("CLASS_REF");if(r){if(r.template){var o=r.value.substr(2,r.value.length-2),a=c.tokenize(o);return{type:"classRefTemplate",args:[e.requireElement("expression",a)],op:function(e,t){return new l("."+t,e.me,!0)},evaluate:function(e){return t.unifiedEval(this,e)}}}{const e=r.value;return{type:"classRef",css:e,evaluate:function(t){return new l(e,t.me,!0)}}}}}));class e extends l{constructor(e,t,n){super(e,t),this.templateParts=n,this.elements=n.filter((e=>e instanceof Element))}get css(){let e="",t=0;for(const n of this.templateParts)n instanceof Element?e+="[data-hs-query-id='"+t+++"']":e+=n;return e}[Symbol.iterator](){this.elements.forEach(((e,t)=>e.dataset.hsQueryId=t));const e=super[Symbol.iterator]();return this.elements.forEach((e=>e.removeAttribute("data-hs-query-id"))),e}}f.addLeafExpression("queryRef",(function(t,n,r){if(r.matchOpToken("<")){var o=r.consumeUntil("/");r.requireOpToken("/"),r.requireOpToken(">");var a=o.map((function(e){return"STRING"===e.type?'"'+e.value+'"':e.value})).join("");if(a.indexOf("$")>=0)var i=!0,u=c.tokenize(a,!0),s=t.parseStringTemplate(u);return{type:"queryRef",css:a,args:s,op:function(t,...n){return i?new e(a,t.me,n):new l(a,t.me)},evaluate:function(e){return n.unifiedEval(this,e)}}}})),f.addLeafExpression("attributeRef",(function(e,t,n){var r=n.matchTokenType("ATTRIBUTE_REF");if(r){var o=r.value;if(0===o.indexOf("["))var a=o.substring(2,o.length-1);else a=o.substring(1);var i="["+a+"]",u=a.split("="),s=u[0],l=u[1];return l&&0===l.indexOf('"')&&(l=l.substring(1,l.length-1)),{type:"attributeRef",name:s,css:i,value:l,op:function(e){var t=e.beingTold||e.me;if(t)return t.getAttribute(s)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addLeafExpression("styleRef",(function(e,t,n){var r=n.matchTokenType("STYLE_REF");if(r){var o=r.value.substr(1);return o.startsWith("computed-")?{type:"computedStyleRef",name:o=o.substr("computed-".length),op:function(e){var n=e.beingTold||e.me;if(n)return t.resolveComputedStyle(n,o)},evaluate:function(e){return t.unifiedEval(this,e)}}:{type:"styleRef",name:o,op:function(e){var n=e.beingTold||e.me;if(n)return t.resolveStyle(n,o)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addGrammarElement("objectKey",(function(e,t,n){var r;if(r=n.matchTokenType("STRING"))return{type:"objectKey",key:r.value,evaluate:function(){return r.value}};if(n.matchOpToken("[")){var o=e.parseElement("expression",n);return n.requireOpToken("]"),{type:"objectKey",expr:o,args:[o],op:function(e,t){return t},evaluate:function(e){return t.unifiedEval(this,e)}}}var a="";do{(r=n.matchTokenType("IDENTIFIER")||n.matchOpToken("-"))&&(a+=r.value)}while(r);return{type:"objectKey",key:a,evaluate:function(){return a}}})),f.addLeafExpression("objectLiteral",(function(e,t,n){if(n.matchOpToken("{")){var r=[],o=[];if(!n.matchOpToken("}")){do{var a=e.requireElement("objectKey",n);n.requireOpToken(":");var i=e.requireElement("expression",n);o.push(i),r.push(a)}while(n.matchOpToken(","));n.requireOpToken("}")}return{type:"objectLiteral",args:[r,o],op:function(e,t,n){for(var r={},o=0;o<t.length;o++)r[t[o]]=n[o];return r},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addGrammarElement("nakedNamedArgumentList",(function(e,t,n){var r=[],o=[];if("IDENTIFIER"===n.currentToken().type)do{var a=n.requireTokenType("IDENTIFIER");n.requireOpToken(":");var i=e.requireElement("expression",n);o.push(i),r.push({name:a,value:i})}while(n.matchOpToken(","));return{type:"namedArgumentList",fields:r,args:[o],op:function(e,t){for(var n={_namedArgList_:!0},o=0;o<t.length;o++)n[r[o].name.value]=t[o];return n},evaluate:function(e){return t.unifiedEval(this,e)}}})),f.addGrammarElement("namedArgumentList",(function(e,t,n){if(n.matchOpToken("(")){var r=e.requireElement("nakedNamedArgumentList",n);return n.requireOpToken(")"),r}})),f.addGrammarElement("symbol",(function(e,t,n){var r="default";n.matchToken("global")?r="global":n.matchToken("element")||n.matchToken("module")?(r="element",n.matchOpToken("'")&&n.requireToken("s")):n.matchToken("local")&&(r="local");let o=n.matchOpToken(":"),a=n.matchTokenType("IDENTIFIER");if(a){var i=a.value;return o&&(i=":"+i),"default"===r&&(0===i.indexOf("$")&&(r="global"),0===i.indexOf(":")&&(r="element")),{type:"symbol",token:a,scope:r,name:i,evaluate:function(e){return t.resolveSymbol(i,e,r)}}}})),f.addGrammarElement("implicitMeTarget",(function(e,t,n){return{type:"implicitMeTarget",evaluate:function(e){return e.beingTold||e.me}}})),f.addLeafExpression("boolean",(function(e,t,n){var r=n.matchToken("true")||n.matchToken("false");if(!r)return;const o="true"===r.value;return{type:"boolean",evaluate:function(e){return o}}})),f.addLeafExpression("null",(function(e,t,n){if(n.matchToken("null"))return{type:"null",evaluate:function(e){return null}}})),f.addLeafExpression("arrayLiteral",(function(e,t,n){if(n.matchOpToken("[")){var r=[];if(!n.matchOpToken("]")){do{var o=e.requireElement("expression",n);r.push(o)}while(n.matchOpToken(","));n.requireOpToken("]")}return{type:"arrayLiteral",values:r,args:[r],op:function(e,t){return t},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addLeafExpression("blockLiteral",(function(e,t,n){if(n.matchOpToken("\\")){var r=[],o=n.matchTokenType("IDENTIFIER");if(o)for(r.push(o);n.matchOpToken(",");)r.push(n.requireTokenType("IDENTIFIER"));n.requireOpToken("-"),n.requireOpToken(">");var a=e.requireElement("expression",n);return{type:"blockLiteral",args:r,expr:a,evaluate:function(e){return function(){for(var t=0;t<r.length;t++)e[r[t].value]=arguments[t];return a.evaluate(e)}}}}})),f.addIndirectExpression("propertyAccess",(function(e,t,n,r){if(n.matchOpToken(".")){var o=n.requireTokenType("IDENTIFIER");return e.parseElement("indirectExpression",n,{type:"propertyAccess",root:r,prop:o,args:[r],op:function(e,n){return t.resolveProperty(n,o.value)},evaluate:function(e){return t.unifiedEval(this,e)}})}})),f.addIndirectExpression("of",(function(e,t,n,r){if(n.matchToken("of")){for(var o=e.requireElement("unaryExpression",n),a=null,i=r;i.root;)a=i,i=i.root;"symbol"!==i.type&&"attributeRef"!==i.type&&"styleRef"!==i.type&&"computedStyleRef"!==i.type&&e.raiseParseError(n,"Cannot take a property of a non-symbol: "+i.type);var u="attributeRef"===i.type,s="styleRef"===i.type||"computedStyleRef"===i.type;if(u||s)var l=i;var c=i.name,f={type:"ofExpression",prop:i.token,root:o,attribute:l,expression:r,args:[o],op:function(e,n){return u?t.resolveAttribute(n,c):s?"computedStyleRef"===i.type?t.resolveComputedStyle(n,c):t.resolveStyle(n,c):t.resolveProperty(n,c)},evaluate:function(e){return t.unifiedEval(this,e)}};return"attributeRef"===i.type&&(f.attribute=i),a?(a.root=f,a.args=[f]):r=f,e.parseElement("indirectExpression",n,r)}})),f.addIndirectExpression("possessive",(function(e,t,n,r){if(!e.possessivesDisabled){var o=n.matchOpToken("'");if(o||"symbol"===r.type&&("my"===r.name||"its"===r.name||"your"===r.name)&&("IDENTIFIER"===n.currentToken().type||"ATTRIBUTE_REF"===n.currentToken().type||"STYLE_REF"===n.currentToken().type)){o&&n.requireToken("s");var a=e.parseElement("attributeRef",n);if(null==a){var i=e.parseElement("styleRef",n);if(null==i)var u=n.requireTokenType("IDENTIFIER")}return e.parseElement("indirectExpression",n,{type:"possessive",root:r,attribute:a||i,prop:u,args:[r],op:function(e,n){if(a)var r=t.resolveAttribute(n,a.name);else r=i?"computedStyleRef"===i.type?t.resolveComputedStyle(n,i.name):t.resolveStyle(n,i.name):t.resolveProperty(n,u.value);return r},evaluate:function(e){return t.unifiedEval(this,e)}})}}})),f.addIndirectExpression("inExpression",(function(e,t,n,r){if(n.matchToken("in")){var o={type:"inExpression",root:r,args:[r,e.requireElement("unaryExpression",n)],op:function(e,n,r){var o=[];if(n.css)t.implicitLoop(r,(function(e){for(var t=e.querySelectorAll(n.css),r=0;r<t.length;r++)o.push(t[r])}));else if(n instanceof Element){var a=!1;if(t.implicitLoop(r,(function(e){e.contains(n)&&(a=!0)})),a)return n}else t.implicitLoop(n,(function(e){t.implicitLoop(r,(function(t){e===t&&o.push(e)}))}));return o},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",n,o)}})),f.addIndirectExpression("asExpression",(function(e,t,n,r){if(n.matchToken("as")){n.matchToken("a")||n.matchToken("an");var o=e.requireElement("dotOrColonPath",n).evaluate();return e.parseElement("indirectExpression",n,{type:"asExpression",root:r,args:[r],op:function(e,n){return t.convertValue(n,o)},evaluate:function(e){return t.unifiedEval(this,e)}})}})),f.addIndirectExpression("functionCall",(function(e,t,n,r){if(n.matchOpToken("(")){var o=[];if(!n.matchOpToken(")")){do{o.push(e.requireElement("expression",n))}while(n.matchOpToken(","));n.requireOpToken(")")}if(r.root)var a={type:"functionCall",root:r,argExressions:o,args:[r.root,o],op:function(e,n,o){t.nullCheck(n,r.root);var a=n[r.prop.value];return t.nullCheck(a,r),a.hyperfunc&&o.push(e),a.apply(n,o)},evaluate:function(e){return t.unifiedEval(this,e)}};else a={type:"functionCall",root:r,argExressions:o,args:[r,o],op:function(e,n,o){return t.nullCheck(n,r),n.hyperfunc&&o.push(e),n.apply(null,o)},evaluate:function(e){return t.unifiedEval(this,e)}};return e.parseElement("indirectExpression",n,a)}})),f.addIndirectExpression("attributeRefAccess",(function(e,t,n,r){var o=e.parseElement("attributeRef",n);if(o)return{type:"attributeRefAccess",root:r,attribute:o,args:[r],op:function(e,n){return t.resolveAttribute(n,o.name)},evaluate:function(e){return p.unifiedEval(this,e)}}})),f.addIndirectExpression("arrayIndex",(function(e,t,n,r){if(n.matchOpToken("[")){var o=!1,a=!1,i=null,u=null;n.matchOpToken("..")?(o=!0,i=e.requireElement("expression",n)):(i=e.requireElement("expression",n),n.matchOpToken("..")&&(a=!0,"R_BRACKET"!==n.currentToken().type&&(u=e.parseElement("expression",n)))),n.requireOpToken("]");var s={type:"arrayIndex",root:r,prop:i,firstIndex:i,secondIndex:u,args:[r,i,u],op:function(e,t,n,r){return null==t?null:o?(n<0&&(n=t.length+n),t.slice(0,n+1)):a?null!=r?(r<0&&(r=t.length+r),t.slice(n,r+1)):t.slice(n):t[n]},evaluate:function(e){return p.unifiedEval(this,e)}};return f.parseElement("indirectExpression",n,s)}}));var d=["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","pc","pt","px"];f.addGrammarElement("postfixExpression",(function(e,t,n){var r=e.parseElement("primaryExpression",n);let o=n.matchAnyToken.apply(n,d)||n.matchOpToken("%");if(o)return{type:"stringPostfix",postfix:o.value,args:[r],op:function(e,t){return""+t+o.value},evaluate:function(e){return t.unifiedEval(this,e)}};var a=null;if(n.matchToken("s")||n.matchToken("seconds")?a=1e3:(n.matchToken("ms")||n.matchToken("milliseconds"))&&(a=1),a)return{type:"timeExpression",time:r,factor:a,args:[r],op:function(e,t){return t*a},evaluate:function(e){return t.unifiedEval(this,e)}};if(n.matchOpToken(":")){var i=n.requireTokenType("IDENTIFIER"),u=!n.matchOpToken("!");return{type:"typeCheck",typeName:i,nullOk:u,args:[r],op:function(e,n){if(t.typeCheck(n,i.value,u))return n;throw new Error("Typecheck failed!  Expected: "+i.value)},evaluate:function(e){return t.unifiedEval(this,e)}}}return r})),f.addGrammarElement("logicalNot",(function(e,t,n){if(n.matchToken("not")){var r=e.requireElement("unaryExpression",n);return{type:"logicalNot",root:r,args:[r],op:function(e,t){return!t},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addGrammarElement("noExpression",(function(e,t,n){if(n.matchToken("no")){var r=e.requireElement("unaryExpression",n);return{type:"noExpression",root:r,args:[r],op:function(e,n){return t.isEmpty(n)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addLeafExpression("some",(function(e,t,n){if(n.matchToken("some")){var r=e.requireElement("expression",n);return{type:"noExpression",root:r,args:[r],op:function(e,n){return!t.isEmpty(n)},evaluate(e){return t.unifiedEval(this,e)}}}})),f.addGrammarElement("negativeNumber",(function(e,t,n){if(n.matchOpToken("-")){var r=e.requireElement("unaryExpression",n);return{type:"negativeNumber",root:r,args:[r],op:function(e,t){return-1*t},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addGrammarElement("unaryExpression",(function(e,t,n){return n.matchToken("the"),e.parseAnyOf(["beepExpression","logicalNot","relativePositionalExpression","positionalExpression","noExpression","negativeNumber","postfixExpression"],n)})),f.addGrammarElement("beepExpression",(function(e,t,n){if(n.matchToken("beep!")){var o=e.parseElement("unaryExpression",n);if(o){o.booped=!0;var a=o.evaluate;return o.evaluate=function(e){let n=a.apply(o,arguments),i=e.me;if(t.triggerEvent(i,"hyperscript:beep",{element:i,expression:o,value:n})){var u,s=n;"String"===(u=n?n instanceof l?"ElementCollection":n.constructor?n.constructor.name:"unknown":"object (null)")?s='"'+s+'"':n instanceof l&&(s=Array.from(n)),r.log("///_ BEEP! The expression ("+o.sourceFor().substr(6)+") evaluates to:",s,"of type "+u)}return n},o}}}));var h=function(e,t,n,r){var o=[];p.forEach(t,(function(t){(t.matches(n)||t===e)&&o.push(t)}));for(var a=0;a<o.length-1;a++)if(o[a]===e)return o[a+1];if(r){var i=o[0];if(i&&i.matches(n))return i}};function t(e,t,n){if(t.contains)return t.contains(n);if(t.includes)return t.includes(n);throw Error("The value of "+e.sourceFor()+" does not have a contains or includes method on it")}function n(e,t,n){if(t.match)return!!t.match(n);if(t.matches)return t.matches(n);throw Error("The value of "+e.sourceFor()+" does not have a match or matches method on it")}f.addGrammarElement("relativePositionalExpression",(function(e,t,n){var r=n.matchAnyToken("next","previous");if(r){if("next"===r.value)var o=!0;var a=e.parseElement("expression",n);if(n.matchToken("from")){n.pushFollow("in");try{var i=e.requireElement("unaryExpression",n)}finally{n.popFollow()}}else i=e.requireElement("implicitMeTarget",n);var u,s=!1;if(n.matchToken("in")){s=!0;var l=e.requireElement("unaryExpression",n)}else u=n.matchToken("within")?e.requireElement("unaryExpression",n):document.body;var c=!1;return n.matchToken("with")&&(n.requireToken("wrapping"),c=!0),{type:"relativePositionalExpression",from:i,forwardSearch:o,inSearch:s,wrapping:c,inElt:l,withinElt:u,operator:r.value,args:[a,i,l,u],op:function(e,t,n,r,a){var i,u,l=t.css;if(null==l)throw"Expected a CSS value";if(s){if(r)return o?h(n,r,l,c):(i=l,u=c,h(n,Array.from(r).reverse(),i,u))}else if(a)return o?function(e,t,n,r){for(var o=t.querySelectorAll(n),a=0;a<o.length;a++){var i=o[a];if(i.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_PRECEDING)return i}if(r)return o[0]}(n,a,l,c):function(e,t,n,r){for(var o=t.querySelectorAll(n),a=o.length-1;a>=0;a--){var i=o[a];if(i.compareDocumentPosition(e)===Node.DOCUMENT_POSITION_FOLLOWING)return i}if(r)return o[o.length-1]}(n,a,l,c)},evaluate:function(e){return t.unifiedEval(this,e)}}}})),f.addGrammarElement("positionalExpression",(function(e,t,n){var r=n.matchAnyToken("first","last","random");if(!r)return;n.matchAnyToken("in","from","of");var o=e.requireElement("unaryExpression",n);const a=r.value;return{type:"positionalExpression",rhs:o,operator:r.value,args:[o],op:function(e,t){if(t&&!Array.isArray(t)&&(t=t.children?t.children:Array.from(t)),t){if("first"===a)return t[0];if("last"===a)return t[t.length-1];if("random"===a)return t[Math.floor(Math.random()*t.length)]}},evaluate:function(e){return t.unifiedEval(this,e)}}})),f.addGrammarElement("mathOperator",(function(e,t,n){var r,o=e.parseElement("unaryExpression",n),a=null;for(r=n.matchAnyOpToken("+","-","*","/","%");r;){var i=r.value;(a=a||r).value!==i&&e.raiseParseError(n,"You must parenthesize math operations with different operators");var u=e.parseElement("unaryExpression",n);o={type:"mathOperator",lhs:o,rhs:u,operator:i,args:[o,u],op:function(e,t,n){return"+"===i?t+n:"-"===i?t-n:"*"===i?t*n:"/"===i?t/n:"%"===i?t%n:void 0},evaluate:function(e){return t.unifiedEval(this,e)}},r=n.matchAnyOpToken("+","-","*","/","%")}return o})),f.addGrammarElement("mathExpression",(function(e,t,n){return e.parseAnyOf(["mathOperator","unaryExpression"],n)})),f.addGrammarElement("comparisonOperator",(function(e,r,o){var a=e.parseElement("mathExpression",o),i=o.matchAnyOpToken("<",">","<=",">=","==","===","!=","!=="),u=i?i.value:null,s=!0,l=!1;if(null==u&&(o.matchToken("is")||o.matchToken("am")?o.matchToken("not")?o.matchToken("in")?u="not in":o.matchToken("a")?(u="not a",l=!0):o.matchToken("empty")?(u="not empty",s=!1):u="!=":o.matchToken("in")?u="in":o.matchToken("a")?(u="a",l=!0):o.matchToken("empty")?(u="empty",s=!1):o.matchToken("less")?(o.requireToken("than"),o.matchToken("or")?(o.requireToken("equal"),o.requireToken("to"),u="<="):u="<"):o.matchToken("greater")?(o.requireToken("than"),o.matchToken("or")?(o.requireToken("equal"),o.requireToken("to"),u=">="):u=">"):u="==":o.matchToken("exist")||o.matchToken("exists")?(u="exist",s=!1):o.matchToken("matches")||o.matchToken("match")?u="match":o.matchToken("contains")||o.matchToken("contain")?u="contain":o.matchToken("includes")||o.matchToken("include")?u="include":(o.matchToken("do")||o.matchToken("does"))&&(o.requireToken("not"),o.matchToken("matches")||o.matchToken("match")?u="not match":o.matchToken("contains")||o.matchToken("contain")?u="not contain":o.matchToken("exist")||o.matchToken("exist")?(u="not exist",s=!1):o.matchToken("include")?u="not include":e.raiseParseError(o,"Expected matches or contains"))),u){if(l)var c=o.requireTokenType("IDENTIFIER"),f=!o.matchOpToken("!");else if(s){var m=e.requireElement("mathExpression",o);"match"!==u&&"not match"!==u||(m=m.css?m.css:m)}var p=a;a={type:"comparisonOperator",operator:u,typeName:c,nullOk:f,lhs:a,rhs:m,args:[a,m],op:function(e,o,a){if("=="===u)return o==a;if("!="===u)return o!=a;if("match"===u)return null!=o&&n(p,o,a);if("not match"===u)return null==o||!n(p,o,a);if("in"===u)return null!=a&&t(m,a,o);if("not in"===u)return null==a||!t(m,a,o);if("contain"===u)return null!=o&&t(p,o,a);if("not contain"===u)return null==o||!t(p,o,a);if("include"===u)return null!=o&&t(p,o,a);if("not include"===u)return null==o||!t(p,o,a);if("==="===u)return o===a;if("!=="===u)return o!==a;if("<"===u)return o<a;if(">"===u)return o>a;if("<="===u)return o<=a;if(">="===u)return o>=a;if("empty"===u)return r.isEmpty(o);if("not empty"===u)return!r.isEmpty(o);if("exist"===u)return r.doesExist(o);if("not exist"===u)return!r.doesExist(o);if("a"===u)return r.typeCheck(o,c.value,f);if("not a"===u)return!r.typeCheck(o,c.value,f);throw"Unknown comparison : "+u},evaluate:function(e){return r.unifiedEval(this,e)}}}return a})),f.addGrammarElement("comparisonExpression",(function(e,t,n){return e.parseAnyOf(["comparisonOperator","mathExpression"],n)})),f.addGrammarElement("logicalOperator",(function(e,t,n){var r,o=e.parseElement("comparisonExpression",n),a=null;for(r=n.matchToken("and")||n.matchToken("or");r;){(a=a||r).value!==r.value&&e.raiseParseError(n,"You must parenthesize logical operations with different operators");var i=e.requireElement("comparisonExpression",n);const u=r.value;o={type:"logicalOperator",operator:u,lhs:o,rhs:i,args:[o,i],op:function(e,t,n){return"and"===u?t&&n:t||n},evaluate:function(e){return t.unifiedEval(this,e)}},r=n.matchToken("and")||n.matchToken("or")}return o})),f.addGrammarElement("logicalExpression",(function(e,t,n){return e.parseAnyOf(["logicalOperator","mathExpression"],n)})),f.addGrammarElement("asyncExpression",(function(e,t,n){return n.matchToken("async")?{type:"asyncExpression",value:e.requireElement("logicalExpression",n),evaluate:function(e){return{asyncWrapper:!0,value:this.value.evaluate(e)}}}:e.parseElement("logicalExpression",n)})),f.addGrammarElement("expression",(function(e,t,n){return n.matchToken("the"),e.parseElement("asyncExpression",n)})),f.addGrammarElement("assignableExpression",(function(e,t,n){n.matchToken("the");var r=e.parseElement("primaryExpression",n);return!r||"symbol"!==r.type&&"ofExpression"!==r.type&&"propertyAccess"!==r.type&&"attributeRefAccess"!==r.type&&"attributeRef"!==r.type&&"styleRef"!==r.type&&"arrayIndex"!==r.type&&"possessive"!==r.type?(f.raiseParseError(n,"A target expression must be writable.  The expression type '"+(r&&r.type)+"' is not."),r):r})),f.addGrammarElement("hyperscript",(function(e,t,n){var r=[];if(n.hasMore())for(;e.featureStart(n.currentToken())||"("===n.currentToken().value;){var o=e.requireElement("feature",n);r.push(o),n.matchToken("end")}return{type:"hyperscript",features:r,apply:function(e,t,n){for(const o of r)o.install(e,t,n)}}}));var v=function(e){var t=[];if("("===e.token(0).value&&(")"===e.token(1).value||","===e.token(2).value||")"===e.token(2).value)){e.matchOpToken("(");do{t.push(e.requireTokenType("IDENTIFIER"))}while(e.matchOpToken(","));e.requireOpToken(")")}return t};function u(e,t,n,r){var o=t.requireElement("eventName",r),a=t.parseElement("namedArgumentList",r);if("send"===e&&r.matchToken("to")||"trigger"===e&&r.matchToken("on"))var i=t.requireElement("expression",r);else i=t.requireElement("implicitMeTarget",r);var u={eventName:o,details:a,to:i,args:[i,o,a],op:function(e,t,r,o){return n.nullCheck(t,i),n.forEach(t,(function(t){n.triggerEvent(t,r,o,e.me)})),n.findNext(u,e)}};return u}f.addFeature("on",(function(e,t,n){if(n.matchToken("on")){var a=!1;n.matchToken("every")&&(a=!0);var i=[],u=null;do{var s=e.requireElement("eventName",n,"Expected event name").evaluate();u=u?u+" or "+s:"on "+s;var l=v(n),c=null;if(n.matchOpToken("[")&&(c=e.requireElement("expression",n),n.requireOpToken("]")),"NUMBER"===n.currentToken().type){var f=n.consumeToken(),m=parseInt(f.value);if(n.matchToken("to"))var d=n.consumeToken(),h=parseInt(d.value);else if(n.matchToken("and")){var E=!0;n.requireToken("on")}}if("intersection"===s){var T={};if(n.matchToken("with")&&(T.with=e.requireElement("expression",n).evaluate()),n.matchToken("having"))do{n.matchToken("margin")?T.rootMargin=e.requireElement("stringLike",n).evaluate():n.matchToken("threshold")?T.threshold=e.requireElement("expression",n).evaluate():e.raiseParseError(n,"Unknown intersection config specification")}while(n.matchToken("and"))}else if("mutation"===s){var y={};if(n.matchToken("of"))do{if(n.matchToken("anything"))y.attributes=!0,y.subtree=!0,y.characterData=!0,y.childList=!0;else if(n.matchToken("childList"))y.childList=!0;else if(n.matchToken("attributes"))y.attributes=!0,y.attributeOldValue=!0;else if(n.matchToken("subtree"))y.subtree=!0;else if(n.matchToken("characterData"))y.characterData=!0,y.characterDataOldValue=!0;else if("ATTRIBUTE_REF"===n.currentToken().type){var k=n.consumeToken();null==y.attributeFilter&&(y.attributeFilter=[]),0==k.value.indexOf("@")?y.attributeFilter.push(k.value.substring(1)):e.raiseParseError(n,"Only shorthand attribute references are allowed here")}else e.raiseParseError(n,"Unknown mutation config specification")}while(n.matchToken("or"));else y.attributes=!0,y.characterData=!0,y.childList=!0}var g=null,x=!1;if(n.matchToken("from")&&(n.matchToken("elsewhere")?x=!0:(g=e.parseElement("expression",n))||e.raiseParseError(n,'Expected either target value or "elsewhere".')),null===g&&!1===x&&n.matchToken("elsewhere")&&(x=!0),n.matchToken("in"))var b=e.parseElement("unaryExpression",n);if(n.matchToken("debounced")){n.requireToken("at");var q=e.requireElement("expression",n).evaluate({})}else if(n.matchToken("throttled")){n.requireToken("at");var w=e.requireElement("expression",n).evaluate({})}i.push({execCount:0,every:a,on:s,args:l,filter:c,from:g,inExpr:b,elsewhere:x,startCount:m,endCount:h,unbounded:E,debounceTime:q,throttleTime:w,mutationSpec:y,intersectionSpec:T,debounced:void 0,lastExec:void 0})}while(n.matchToken("or"));var N=!0;if(!a&&n.matchToken("queue"))if(n.matchToken("all"))N=!1;else if(n.matchToken("first"))var S=!0;else if(n.matchToken("none"))var I=!0;else n.requireToken("last");var C=e.requireElement("commandList",n);if(e.ensureTerminated(C),n.matchToken("catch")){var R=n.requireTokenType("IDENTIFIER").value,L=e.requireElement("commandList",n);e.ensureTerminated(L)}if(n.matchToken("finally")){var O=e.requireElement("commandList",n);e.ensureTerminated(O)}var A={displayName:u,events:i,start:C,every:a,execCount:0,errorHandler:L,errorSymbol:R,execute:function(e){let n=t.getEventQueueFor(e.me,A);if(n.executing&&!1===a){if(I||S&&n.queue.length>0)return;return N&&(n.queue.length=0),void n.queue.push(e)}A.execCount++,n.executing=!0,e.meta.onHalt=function(){n.executing=!1;var e=n.queue.shift();e&&setTimeout((function(){A.execute(e)}),1)},e.meta.reject=function(n){r.error(n.message?n.message:n);var o=t.getHyperTrace(e,n);o&&o.print(),t.triggerEvent(e.me,"exception",{error:n})},C.execute(e)},install:function(e,n){for(const n of A.events){var r;r=n.elsewhere?[document]:n.from?n.from.evaluate(t.makeContext(e,A,e,null)):[e],t.implicitLoop(r,(function(r){var a=n.on;if(n.mutationSpec&&(a="hyperscript:mutation",new MutationObserver((function(e,t){A.executing||p.triggerEvent(r,a,{mutationList:e,observer:t})})).observe(r,n.mutationSpec)),n.intersectionSpec){a="hyperscript:insersection";const e=new IntersectionObserver((function(t){for(const i of t){var n={observer:e};(n=o(n,i)).intersecting=i.isIntersecting,p.triggerEvent(r,a,n)}}),n.intersectionSpec);e.observe(r)}(r.addEventListener||r.on).call(r,a,(function o(i){if("undefined"!=typeof Node&&e instanceof Node&&r!==e&&!e.isConnected)r.removeEventListener(a,o);else{var u=t.makeContext(e,A,e,i);if(!n.elsewhere||!e.contains(i.target)){n.from&&(u.result=r);for(const e of n.args){let t=u.event[e.value];void 0!==t?u[e.value]=t:"detail"in u.event&&(u[e.value]=u.event.detail[e.value])}if(u.meta.errorHandler=L,u.meta.errorSymbol=R,u.meta.finallyHandler=O,n.filter){var s=u.meta.context;u.meta.context=u.event;try{if(!n.filter.evaluate(u))return}finally{u.meta.context=s}}if(n.inExpr)for(var l=i.target;;){if(l.matches&&l.matches(n.inExpr.css)){u.result=l;break}if(null==(l=l.parentElement))return}if(n.execCount++,n.startCount)if(n.endCount){if(n.execCount<n.startCount||n.execCount>n.endCount)return}else if(n.unbounded){if(n.execCount<n.startCount)return}else if(n.execCount!==n.startCount)return;if(n.debounceTime)return n.debounced&&clearTimeout(n.debounced),void(n.debounced=setTimeout((function(){A.execute(u)}),n.debounceTime));if(n.throttleTime){if(n.lastExec&&Date.now()<n.lastExec+n.throttleTime)return;n.lastExec=Date.now()}A.execute(u)}}}))}))}}};return e.setParent(C,A),A}})),f.addFeature("def",(function(e,t,n){if(n.matchToken("def")){var r=e.requireElement("dotOrColonPath",n).evaluate(),o=r.split("."),a=o.pop(),i=[];if(n.matchOpToken("("))if(n.matchOpToken(")"));else{do{i.push(n.requireTokenType("IDENTIFIER"))}while(n.matchOpToken(","));n.requireOpToken(")")}var u=e.requireElement("commandList",n);if(n.matchToken("catch"))var s=n.requireTokenType("IDENTIFIER").value,l=e.parseElement("commandList",n);if(n.matchToken("finally")){var c=e.requireElement("commandList",n);e.ensureTerminated(c)}var f={displayName:a+"("+i.map((function(e){return e.value})).join(", ")+")",name:a,args:i,start:u,errorHandler:l,errorSymbol:s,finallyHandler:c,install:function(e,n){var m=function(){var r=t.makeContext(n,f,e,null);r.meta.errorHandler=l,r.meta.errorSymbol=s,r.meta.finallyHandler=c;for(var o=0;o<i.length;o++){var a=i[o],m=arguments[o];a&&(r[a.value]=m)}r.meta.caller=arguments[i.length],r.meta.caller&&(r.meta.callingCommand=r.meta.caller.meta.command);var p,d=null,h=new Promise((function(e,t){p=e,d=t}));return u.execute(r),r.meta.returned?r.meta.returnValue:(r.meta.resolve=p,r.meta.reject=d,h)};m.hyperfunc=!0,m.hypername=r,t.assignToNamespace(e,o,a,m)}};return e.ensureTerminated(u),l&&e.ensureTerminated(l),e.setParent(u,f),f}})),f.addFeature("set",(function(e,t,n){let r=e.parseElement("setCommand",n);if(r){"element"!==r.target.scope&&e.raiseParseError(n,"variables declared at the feature level must be element scoped.");let o={start:r,install:function(e,n){r&&r.execute(t.makeContext(e,o,e,null))}};return e.ensureTerminated(r),o}})),f.addFeature("init",(function(e,t,n){if(n.matchToken("init")){var r=e.requireElement("commandList",n),o={start:r,install:function(e,n){setTimeout((function(){r&&r.execute(t.makeContext(e,o,e,null))}),0)}};return e.ensureTerminated(r),e.setParent(r,o),o}})),f.addFeature("worker",(function(e,t,n){n.matchToken("worker")&&e.raiseParseError(n,"In order to use the 'worker' feature, include the _hyperscript worker plugin. See https://hyperscript.org/features/worker/ for more info.")})),f.addFeature("behavior",(function(e,t,n){if(n.matchToken("behavior")){var r=e.requireElement("dotOrColonPath",n).evaluate(),o=r.split("."),i=o.pop(),u=[];if(n.matchOpToken("(")&&!n.matchOpToken(")")){do{u.push(n.requireTokenType("IDENTIFIER").value)}while(n.matchOpToken(","));n.requireOpToken(")")}for(var l=e.requireElement("hyperscript",n),c=0;c<l.features.length;c++)l.features[c].behavior=r;return{install:function(e,n){t.assignToNamespace(s.document&&s.document.body,o,i,(function(e,n,o){for(var i=a(t.getInternalData(e),r+"Scope"),s=0;s<u.length;s++)i[u[s]]=o[u[s]];l.apply(e,n)}))}}}})),f.addFeature("install",(function(e,t,n){if(n.matchToken("install")){var r,o=e.requireElement("dotOrColonPath",n).evaluate(),a=o.split("."),i=e.parseElement("namedArgumentList",n);return r={install:function(e,n){t.unifiedEval({args:[i],op:function(t,r){for(var i=s,u=0;u<a.length;u++)if("object"!=typeof(i=i[a[u]])&&"function"!=typeof i)throw new Error("No such behavior defined as "+o);if(!(i instanceof Function))throw new Error(o+" is not a behavior");i(e,n,r)}},t.makeContext(e,r,e))}}}})),f.addGrammarElement("jsBody",(function(e,t,n){for(var r=n.currentToken().start,o=n.currentToken(),a=[],i="",u=!1;n.hasMore();){o=n.consumeToken();var s=n.token(0,!0);if("IDENTIFIER"===s.type&&"end"===s.value)break;u?"IDENTIFIER"===o.type||"NUMBER"===o.type?i+=o.value:(""!==i&&a.push(i),i="",u=!1):"IDENTIFIER"===o.type&&"function"===o.value&&(u=!0)}return{type:"jsBody",exposedFunctionNames:a,jsSource:n.source.substring(r,o.end+1)}})),f.addFeature("js",(function(e,t,n){if(n.matchToken("js")){var r=e.requireElement("jsBody",n),a=r.jsSource+"\nreturn { "+r.exposedFunctionNames.map((function(e){return e+":"+e})).join(",")+" } ",i=new Function(a);return{jsSource:a,function:i,exposedFunctionNames:r.exposedFunctionNames,install:function(){o(s,i())}}}})),f.addCommand("js",(function(e,t,n){if(n.matchToken("js")){var r=[];if(n.matchOpToken("("))if(n.matchOpToken(")"));else{do{var o=n.requireTokenType("IDENTIFIER");r.push(o.value)}while(n.matchOpToken(","));n.requireOpToken(")")}var a=e.requireElement("jsBody",n);n.matchToken("end");var u=i(Function,r.concat([a.jsSource]));return{jsSource:a.jsSource,function:u,inputs:r,op:function(e){var n=[];r.forEach((function(r){n.push(t.resolveSymbol(r,e,"default"))}));var o=u.apply(s,n);return o&&"function"==typeof o.then?new Promise((function(n){o.then((function(r){e.result=r,n(t.findNext(this,e))}))})):(e.result=o,t.findNext(this,e))}}}})),f.addCommand("async",(function(e,t,n){if(n.matchToken("async")){if(n.matchToken("do")){for(var r=o=e.requireElement("commandList",n);r.next;)r=r.next;r.next=t.HALT,n.requireToken("end")}else var o=e.requireElement("command",n);var a={body:o,op:function(e){return setTimeout((function(){o.execute(e)})),t.findNext(this,e)}};return e.setParent(o,a),a}})),f.addCommand("tell",(function(e,t,n){var r=n.currentToken();if(n.matchToken("tell")){var o=e.requireElement("expression",n),a=e.requireElement("commandList",n);n.hasMore()&&!e.featureStart(n.currentToken())&&n.requireToken("end");var i="tell_"+r.start,u={value:o,body:a,args:[o],resolveNext:function(e){var n=e.meta.iterators[i];return n.index<n.value.length?(e.beingTold=n.value[n.index++],a):(e.beingTold=n.originalBeingTold,this.next?this.next:t.findNext(this.parent,e))},op:function(e,t){return null==t?t=[]:Array.isArray(t)||t instanceof NodeList||(t=[t]),e.meta.iterators[i]={originalBeingTold:e.beingTold,index:0,value:t},this.resolveNext(e)}};return e.setParent(a,u),u}})),f.addCommand("wait",(function(e,t,n){if(n.matchToken("wait")){var r,o;if(n.matchToken("for")){n.matchToken("a");var a=[];do{var i=n.token(0);a.push("NUMBER"===i.type||"L_PAREN"===i.type?{time:e.requireElement("expression",n).evaluate()}:{name:f.requireElement("dotOrColonPath",n,"Expected event name").evaluate(),args:v(n)})}while(n.matchToken("or"));if(n.matchToken("from"))var u=e.requireElement("expression",n);return r={event:a,on:u,args:[u],op:function(e,n){var r=n||e.me;if(!(r instanceof EventTarget))throw new Error("Not a valid event target: "+this.on.sourceFor());return new Promise((n=>{var o=!1;for(const u of a){var i=r=>{if(e.result=r,u.args)for(const t of u.args)e[t.value]=r[t.value]||(r.detail?r.detail[t.value]:null);o||(o=!0,n(t.findNext(this,e)))};u.name?r.addEventListener(u.name,i,{once:!0}):null!=u.time&&setTimeout(i,u.time,u.time)}}))}},r}return n.matchToken("a")?(n.requireToken("tick"),o=0):o=f.requireElement("expression",n),{type:"waitCmd",time:o,args:[o],op:function(e,n){return new Promise((r=>{setTimeout((()=>{r(t.findNext(this,e))}),n)}))},execute:function(e){return t.unifiedExec(this,e)}}}})),f.addGrammarElement("dotOrColonPath",(function(e,t,n){var r=n.matchTokenType("IDENTIFIER");if(r){var o=[r.value],a=n.matchOpToken(".")||n.matchOpToken(":");if(a)do{o.push(n.requireTokenType("IDENTIFIER","NUMBER").value)}while(n.matchOpToken(a.value));return{type:"dotOrColonPath",path:o,evaluate:function(){return o.join(a?a.value:"")}}}})),f.addGrammarElement("eventName",(function(e,t,n){var r;return(r=n.matchTokenType("STRING"))?{evaluate:function(){return r.value}}:e.parseElement("dotOrColonPath",n)})),f.addCommand("trigger",(function(e,t,n){if(n.matchToken("trigger"))return u("trigger",e,t,n)})),f.addCommand("send",(function(e,t,n){if(n.matchToken("send"))return u("send",e,t,n)}));var E=function(e,t,n,r){if(r)if(e.commandBoundary(n.currentToken()))e.raiseParseError(n,"'return' commands must return a value.  If you do not wish to return a value, use 'exit' instead.");else var o=e.requireElement("expression",n);var a={value:o,args:[o],op:function(e,n){var r=e.meta.resolve;return e.meta.returned=!0,e.meta.returnValue=n,r&&(n?r(n):r()),t.HALT}};return a};f.addCommand("return",(function(e,t,n){if(n.matchToken("return"))return E(e,t,n,!0)})),f.addCommand("exit",(function(e,t,n){if(n.matchToken("exit"))return E(e,t,n,!1)})),f.addCommand("halt",(function(e,t,n){if(n.matchToken("halt")){if(n.matchToken("the")){n.requireToken("event"),n.matchOpToken("'")&&n.requireToken("s");var r=!0}if(n.matchToken("bubbling"))var o=!0;else if(n.matchToken("default"))var a=!0;var i=E(e,t,n,!1);return{keepExecuting:!0,bubbling:o,haltDefault:a,exit:i,op:function(e){if(e.event)return o?e.event.stopPropagation():(a||e.event.stopPropagation(),e.event.preventDefault()),r?t.findNext(this,e):i}}}})),f.addCommand("log",(function(e,t,n){if(n.matchToken("log")){for(var o=[e.parseElement("expression",n)];n.matchOpToken(",");)o.push(e.requireElement("expression",n));if(n.matchToken("with"))var a=e.requireElement("expression",n);var i={exprs:o,withExpr:a,args:[a,o],op:function(e,n,o){return n?n.apply(null,o):r.log.apply(null,o),t.findNext(this,e)}};return i}})),f.addCommand("throw",(function(e,t,n){if(n.matchToken("throw")){var r=e.requireElement("expression",n),o={expr:r,args:[r],op:function(e,n){throw t.registerHyperTrace(e,n),n}};return o}}));var T=function(e,t,n){var r=e.requireElement("expression",n),o={expr:r,args:[r],op:function(e,n){return e.result=n,t.findNext(o,e)}};return o};f.addCommand("call",(function(e,t,n){if(n.matchToken("call")){var r=T(e,t,n);return r.expr&&"functionCall"!==r.expr.type&&e.raiseParseError(n,"Must be a function invocation"),r}})),f.addCommand("get",(function(e,t,n){if(n.matchToken("get"))return T(e,t,n)})),f.addCommand("make",(function(e,t,n){if(n.matchToken("make")){n.matchToken("a")||n.matchToken("an");var r,o=e.requireElement("expression",n),a=[];if("queryRef"!==o.type&&n.matchToken("from"))do{a.push(e.requireElement("expression",n))}while(n.matchOpToken(","));if(n.matchToken("called"))var u=e.requireElement("symbol",n);return"queryRef"===o.type?r={op:function(e){for(var n,r,a="div",i=[],s=/(?:(^|#|\.)([^#\. ]+))/g;n=s.exec(o.css);)""===n[1]?a=n[2].trim():"#"===n[1]?r=n[2].trim():i.push(n[2].trim());var l=document.createElement(a);void 0!==r&&(l.id=r);for(var c=0;c<i.length;c++)l.classList.add(i[c]);return e.result=l,u&&t.setSymbol(u.name,e,u.scope,l),t.findNext(this,e)}}:(r={args:[o,a],op:function(e,n,r){return e.result=i(n,r),u&&t.setSymbol(u.name,e,u.scope,e.result),t.findNext(this,e)}},r)}})),f.addGrammarElement("pseudoCommand",(function(e,t,n){let r=n.token(1);if(!r||!r.op||"."!==r.value&&"("!==r.value)return null;for(var o=e.requireElement("primaryExpression",n),a=o.root,i=o;null!=a.root;)i=i.root,a=a.root;if("functionCall"!==o.type&&e.raiseParseError(n,"Pseudo-commands must be function calls"),"functionCall"===i.type&&null==i.root.root)if(n.matchAnyToken("the","to","on","with","into","from","at"))var u=e.requireElement("expression",n);else n.matchToken("me")&&(u=e.requireElement("implicitMeTarget",n));if(u)var s={type:"pseudoCommand",root:u,argExressions:i.argExressions,args:[u,i.argExressions],op:function(e,n,r){t.nullCheck(n,u);var o=n[i.root.name];return t.nullCheck(o,i),o.hyperfunc&&r.push(e),e.result=o.apply(n,r),t.findNext(s,e)},execute:function(e){return t.unifiedExec(this,e)}};else s={type:"pseudoCommand",expr:o,args:[o],op:function(e,n){return e.result=n,t.findNext(s,e)},execute:function(e){return t.unifiedExec(this,e)}};return s}));var y=function(e,t,n,r,o){var a="symbol"===r.type,i="attributeRef"===r.type,u="styleRef"===r.type,s="arrayIndex"===r.type;i||u||a||null!=r.root||e.raiseParseError(n,"Can only put directly into symbols, not references");var l=null,c=null;if(a);else if(i||u){l=e.requireElement("implicitMeTarget",n);var f=r}else s?(c=r.firstIndex,l=r.root):(c=r.prop?r.prop.value:null,f=r.attribute,l=r.root);var m={target:r,symbolWrite:a,value:o,args:[l,c,o],op:function(e,n,o,i){return a?t.setSymbol(r.name,e,r.scope,i):(t.nullCheck(n,l),s?n[o]=i:t.implicitLoop(n,(function(e){f?"attributeRef"===f.type?null==i?e.removeAttribute(f.name):e.setAttribute(f.name,i):e.style[f.name]=i:e[o]=i}))),t.findNext(this,e)}};return m};f.addCommand("default",(function(e,t,n){if(n.matchToken("default")){var r=e.requireElement("assignableExpression",n);n.requireToken("to");var o=e.requireElement("expression",n),a=y(e,t,n,r,o),i={target:r,value:o,setter:a,args:[r],op:function(e,n){return n?t.findNext(this,e):a}};return a.parent=i,i}})),f.addCommand("set",(function(e,t,n){if(n.matchToken("set")){if("L_BRACE"===n.currentToken().type){var r=e.requireElement("objectLiteral",n);n.requireToken("on");var a={objectLiteral:r,target:i=e.requireElement("expression",n),args:[r,i],op:function(e,n,r){return o(r,n),t.findNext(this,e)}};return a}try{n.pushFollow("to");var i=e.requireElement("assignableExpression",n)}finally{n.popFollow()}n.requireToken("to");var u=e.requireElement("expression",n);return y(e,t,n,i,u)}})),f.addCommand("if",(function(e,t,n){if(n.matchToken("if")){var r=e.requireElement("expression",n);n.matchToken("then");var o=e.parseElement("commandList",n);if(n.matchToken("else")||n.matchToken("otherwise"))var a=e.parseElement("commandList",n);n.hasMore()&&n.requireToken("end");var i={expr:r,trueBranch:o,falseBranch:a,args:[r],op:function(e,n){return n?o:a||t.findNext(this,e)}};return e.setParent(o,i),e.setParent(a,i),i}}));var k=function(e,t,n,r){var o,a=t.currentToken();if(t.matchToken("for")||r){var i=t.requireTokenType("IDENTIFIER");o=i.value,t.requireToken("in");var u=e.requireElement("expression",t)}else if(t.matchToken("in"))o="it",u=e.requireElement("expression",t);else if(t.matchToken("while"))var s=e.requireElement("expression",t);else if(t.matchToken("until")){var l=!0;if(t.matchToken("event")){var c=f.requireElement("dotOrColonPath",t,"Expected event name");if(t.matchToken("from"))var m=e.requireElement("expression",t)}else s=e.requireElement("expression",t)}else if(e.commandBoundary(t.currentToken())||"forever"===t.currentToken().value){t.matchToken("forever");var p=!0}else{var d=e.requireElement("expression",t);t.requireToken("times")}if(t.matchToken("index"))var h=(i=t.requireTokenType("IDENTIFIER")).value;var v=e.parseElement("commandList",t);if(v&&c){for(var E=v;E.next;)E=E.next;var T={type:"waitATick",op:function(){return new Promise((function(e){setTimeout((function(){e(n.findNext(T))}),0)}))}};E.next=T}if(t.hasMore()&&t.requireToken("end"),null==o)var y=o="_implicit_repeat_"+a.start;else y=o+"_"+a.start;var k={identifier:o,indexIdentifier:h,slot:y,expression:u,forever:p,times:d,until:l,event:c,on:m,whileExpr:s,resolveNext:function(){return this},loop:v,args:[s,d],op:function(e,t,r){var a=e.meta.iterators[y],i=!1,u=null;if(this.forever)i=!0;else if(this.until)i=c?!1===e.meta.iterators[y].eventFired:!0!==t;else if(s)i=t;else if(r)i=a.index<r;else{var l=a.iterator.next();i=!l.done,u=l.value}return i?(e.result=a.value?e[o]=u:a.index,h&&(e[h]=a.index),a.index++,v):(e.meta.iterators[y]=null,n.findNext(this.parent,e))}};e.setParent(v,k);var g={name:"repeatInit",args:[u,c,m],op:function(e,t,n,r){var o={index:0,value:t,eventFired:!1};return e.meta.iterators[y]=o,t&&t[Symbol.iterator]&&(o.iterator=t[Symbol.iterator]()),c&&(r||e.me).addEventListener(n,(function(t){e.meta.iterators[y].eventFired=!0}),{once:!0}),k},execute:function(e){return n.unifiedExec(this,e)}};return e.setParent(k,g),g};function m(e,t){var n,r="text";return e.matchToken("a")||e.matchToken("an"),e.matchToken("json")||e.matchToken("Object")?r="json":e.matchToken("response")?r="response":e.matchToken("html")?r="html":e.matchToken("text")||(n=t.requireElement("dotOrColonPath",e).evaluate()),{type:r,conversion:n}}f.addCommand("repeat",(function(e,t,n){if(n.matchToken("repeat"))return k(e,n,t,!1)})),f.addCommand("for",(function(e,t,n){if(n.matchToken("for"))return k(e,n,t,!0)})),f.addCommand("continue",(function(e,t,n){if(n.matchToken("continue"))return{op:function(t){for(var r=this.parent;;r=r.parent)if(null==r&&e.raiseParseError(n,"Command `continue` cannot be used outside of a `repeat` loop."),null!=r.loop)return r.resolveNext(t)}}})),f.addCommand("break",(function(e,t,n){if(n.matchToken("break"))return{op:function(r){for(var o=this.parent;;o=o.parent)if(null==o&&e.raiseParseError(n,"Command `continue` cannot be used outside of a `repeat` loop."),null!=o.loop)return t.findNext(o.parent,r)}}})),f.addGrammarElement("stringLike",(function(e,t,n){return f.parseAnyOf(["string","nakedString"],n)})),f.addCommand("append",(function(e,t,n){if(n.matchToken("append")){var r,o=e.requireElement("expression",n),a={type:"symbol",evaluate:function(e){return t.resolveSymbol("result",e)}};r=n.matchToken("to")?e.requireElement("expression",n):a;var i=null;"symbol"!==r.type&&"attributeRef"!==r.type&&null==r.root||(i=y(e,t,n,r,a));var u={value:o,target:r,args:[r,o],op:function(e,n,r){if(Array.isArray(n))return n.push(r),t.findNext(this,e);if(n instanceof Element)return n.innerHTML+=r,t.findNext(this,e);if(i)return e.result=(n||"")+r,i;throw Error("Unable to append a value!")},execute:function(e){return t.unifiedExec(this,e)}};return null!=i&&(i.parent=u),u}})),f.addCommand("increment",(function(e,t,n){if(n.matchToken("increment")){var r,o=e.parseElement("assignableExpression",n);n.matchToken("by")&&(r=e.requireElement("expression",n));var a={type:"implicitIncrementOp",target:o,args:[o,r],op:function(e,t,n){var r=(t=t?parseFloat(t):0)+(n=n?parseFloat(n):1);return e.result=r,r},evaluate:function(e){return t.unifiedEval(this,e)}};return y(e,t,n,o,a)}})),f.addCommand("decrement",(function(e,t,n){if(n.matchToken("decrement")){var r,o=e.parseElement("assignableExpression",n);n.matchToken("by")&&(r=e.requireElement("expression",n));var a={type:"implicitDecrementOp",target:o,args:[o,r],op:function(e,t,n){var r=(t=t?parseFloat(t):0)-(n=n?parseFloat(n):1);return e.result=r,r},evaluate:function(e){return t.unifiedEval(this,e)}};return y(e,t,n,o,a)}})),f.addCommand("fetch",(function(e,t,n){if(n.matchToken("fetch")){var r=e.requireElement("stringLike",n);if(n.matchToken("as"))var o=m(n,e);if(n.matchToken("with")&&"{"!==n.currentToken().value)var a=e.parseElement("nakedNamedArgumentList",n);else a=e.parseElement("objectLiteral",n);null==o&&n.matchToken("as")&&(o=m(n,e));var i=o?o.type:"text",u=o?o.conversion:null,s={url:r,argExpressions:a,args:[r,a],op:function(e,n,r){var o=r||{};o.sender=e.me,o.headers=o.headers||{};var a=new AbortController;let l=e.me.addEventListener("fetch:abort",(function(){a.abort()}),{once:!0});o.signal=a.signal,t.triggerEvent(e.me,"hyperscript:beforeFetch",o),t.triggerEvent(e.me,"fetch:beforeRequest",o);var c=!1;return(r=o).timeout&&setTimeout((function(){c||a.abort()}),r.timeout),fetch(n,r).then((function(n){let r={response:n};return t.triggerEvent(e.me,"fetch:afterResponse",r),n=r.response,"response"===i?(e.result=n,t.triggerEvent(e.me,"fetch:afterRequest",{result:n}),c=!0,t.findNext(s,e)):"json"===i?n.json().then((function(n){return e.result=n,t.triggerEvent(e.me,"fetch:afterRequest",{result:n}),c=!0,t.findNext(s,e)})):n.text().then((function(n){return u&&(n=t.convertValue(n,u)),"html"===i&&(n=t.convertValue(n,"Fragment")),e.result=n,t.triggerEvent(e.me,"fetch:afterRequest",{result:n}),c=!0,t.findNext(s,e)}))})).catch((function(n){throw t.triggerEvent(e.me,"fetch:error",{reason:n}),n})).finally((function(){e.me.removeEventListener("fetch:abort",l)}))}};return s}}))}if("document"in s){var g=Array.from(document.querySelectorAll("script[type='text/hyperscript'][src]"));Promise.all(g.map((function(e){return fetch(e.src).then((function(e){return e.text()}))}))).then((function(e){return e.forEach(p.evaluate)})).then((function(){var e;e=function(){var e,t;(t=(e=document.querySelector('meta[name="htmx-config"]'))?function(e){try{return JSON.parse(e)}catch(e){return t=e,r.error?r.error(t):r.log&&r.log("ERROR: ",t),null}var t}(e.content):null)&&(u.config=o(u.config,t)),p.processNode(document.documentElement),document.addEventListener("htmx:load",(function(e){p.processNode(e.detail.elt)}))},"loading"!==document.readyState?setTimeout(e):document.addEventListener("DOMContentLoaded",e)}))}var x=u=o((function(e,t){return p.evaluate(e,t)}),{internals:{lexer:c,parser:f,runtime:p},ElementCollection:l,addFeature:function(e,t){f.addFeature(e,t)},addCommand:function(e,t){f.addCommand(e,t)},addLeafExpression:function(e,t){f.addLeafExpression(e,t)},addIndirectExpression:function(e,t){f.addIndirectExpression(e,t)},evaluate:p.evaluate.bind(p),parse:p.parse.bind(p),processNode:p.processNode.bind(p),config:{attributes:"_, script, data-script",defaultTransition:"all 500ms ease-in",disableSelector:"[disable-scripting], [data-disable-scripting]",conversions:m}});(e=>{e.addCommand("settle",(function(e,t,n){if(n.matchToken("settle")){if(e.commandBoundary(n.currentToken()))r=e.requireElement("implicitMeTarget",n);else var r=e.requireElement("expression",n);var o={type:"settleCmd",args:[r],op:function(e,n){t.nullCheck(n,r);var a=null,i=!1,u=new Promise((function(e){a=e}));return n.addEventListener("transitionstart",(function(){i=!0}),{once:!0}),setTimeout((function(){i||a(t.findNext(o,e))}),500),n.addEventListener("transitionend",(function(){a(t.findNext(o,e))}),{once:!0}),u},execute:function(e){return t.unifiedExec(this,e)}};return o}})),e.addCommand("add",(function(e,t,n){if(n.matchToken("add")){var r=e.parseElement("classRef",n),o=null,a=null;if(null==r)null==(o=e.parseElement("attributeRef",n))&&null==(a=e.parseElement("styleLiteral",n))&&e.raiseParseError(n,"Expected either a class reference or attribute expression");else for(var i=[r];r=e.parseElement("classRef",n);)i.push(r);if(n.matchToken("to"))var u=e.requireElement("expression",n);else u=e.requireElement("implicitMeTarget",n);if(n.matchToken("when")){a&&e.raiseParseError(n,"Only class and properties are supported with a when clause");var s=e.requireElement("expression",n)}return i?{classRefs:i,to:u,args:[u,i],op:function(e,n,r){return t.nullCheck(n,u),t.forEach(r,(function(r){t.implicitLoop(n,(function(n){s?(e.result=n,t.evaluateNoPromise(s,e)?n instanceof Element&&n.classList.add(r.className):n instanceof Element&&n.classList.remove(r.className),e.result=null):n instanceof Element&&n.classList.add(r.className)}))})),t.findNext(this,e)}}:o?{type:"addCmd",attributeRef:o,to:u,args:[u],op:function(e,n,r){return t.nullCheck(n,u),t.implicitLoop(n,(function(n){s?(e.result=n,t.evaluateNoPromise(s,e)?n.setAttribute(o.name,o.value):n.removeAttribute(o.name),e.result=null):n.setAttribute(o.name,o.value)})),t.findNext(this,e)},execute:function(e){return t.unifiedExec(this,e)}}:{type:"addCmd",cssDeclaration:a,to:u,args:[u,a],op:function(e,n,r){return t.nullCheck(n,u),t.implicitLoop(n,(function(e){e.style.cssText+=r})),t.findNext(this,e)},execute:function(e){return t.unifiedExec(this,e)}}}})),e.internals.parser.addGrammarElement("styleLiteral",(function(e,t,n){if(n.matchOpToken("{")){for(var r=[""],o=[];n.hasMore();){if(n.matchOpToken("\\"))n.consumeToken();else{if(n.matchOpToken("}"))break;if(n.matchToken("$")){var a=n.matchOpToken("{"),i=e.parseElement("expression",n);a&&n.requireOpToken("}"),o.push(i),r.push("")}else{var u=n.consumeToken();r[r.length-1]+=n.source.substring(u.start,u.end)}}r[r.length-1]+=n.lastWhitespace()}return{type:"styleLiteral",args:[o],op:function(e,t){var n="";return r.forEach((function(e,r){n+=e,r in t&&(n+=t[r])})),n},evaluate:function(e){return t.unifiedEval(this,e)}}}})),e.addCommand("remove",(function(e,t,n){if(n.matchToken("remove")){var r=e.parseElement("classRef",n),o=null,a=null;if(null==r)null==(o=e.parseElement("attributeRef",n))&&null==(a=e.parseElement("expression",n))&&e.raiseParseError(n,"Expected either a class reference, attribute expression or value expression");else for(var i=[r];r=e.parseElement("classRef",n);)i.push(r);if(n.matchToken("from"))var u=e.requireElement("expression",n);else u=e.requireElement("implicitMeTarget",n);return a?{elementExpr:a,from:u,args:[a],op:function(e,n){return t.nullCheck(n,a),t.implicitLoop(n,(function(e){e.parentElement&&e.parentElement.removeChild(e)})),t.findNext(this,e)}}:{classRefs:i,attributeRef:o,elementExpr:a,from:u,args:[i,u],op:function(e,n,r){return t.nullCheck(r,u),n?t.forEach(n,(function(e){t.implicitLoop(r,(function(t){t.classList.remove(e.className)}))})):t.implicitLoop(r,(function(e){e.removeAttribute(o.name)})),t.findNext(this,e)}}}})),e.addCommand("toggle",(function(e,t,n){if(n.matchToken("toggle")){if(n.matchAnyToken("the","my"),"STYLE_REF"===n.currentToken().type){var o=n.consumeToken().value.substr(1),a=!0,i=r(e,n,o);if(n.matchToken("of")){n.pushFollow("with");try{var u=e.requireElement("expression",n)}finally{n.popFollow()}}else u=e.requireElement("implicitMeTarget",n)}else if(n.matchToken("between")){var s=!0,l=e.parseElement("classRef",n);n.requireToken("and");var c=e.requireElement("classRef",n)}else{l=e.parseElement("classRef",n);var f=null;if(null==l)null==(f=e.parseElement("attributeRef",n))&&e.raiseParseError(n,"Expected either a class reference or attribute expression");else for(var m=[l];l=e.parseElement("classRef",n);)m.push(l)}if(!0!==a&&(u=n.matchToken("on")?e.requireElement("expression",n):e.requireElement("implicitMeTarget",n)),n.matchToken("for"))var p=e.requireElement("expression",n);else if(n.matchToken("until")){var d=e.requireElement("dotOrColonPath",n,"Expected event name");if(n.matchToken("from"))var h=e.requireElement("expression",n)}var v={classRef:l,classRef2:c,classRefs:m,attributeRef:f,on:u,time:p,evt:d,from:h,toggle:function(e,n,r,o){t.nullCheck(e,u),a?t.implicitLoop(e,(function(e){i("toggle",e)})):s?t.implicitLoop(e,(function(e){e.classList.contains(n.className)?(e.classList.remove(n.className),e.classList.add(r.className)):(e.classList.add(n.className),e.classList.remove(r.className))})):o?t.forEach(o,(function(n){t.implicitLoop(e,(function(e){e.classList.toggle(n.className)}))})):t.forEach(e,(function(e){e.hasAttribute(f.name)?e.removeAttribute(f.name):e.setAttribute(f.name,f.value)}))},args:[u,p,d,h,l,c,m],op:function(e,n,r,o,a,i,u,s){return r?new Promise((function(o){v.toggle(n,i,u,s),setTimeout((function(){v.toggle(n,i,u,s),o(t.findNext(v,e))}),r)})):o?new Promise((function(r){(a||e.me).addEventListener(o,(function(){v.toggle(n,i,u,s),r(t.findNext(v,e))}),{once:!0}),v.toggle(n,i,u,s)})):(this.toggle(n,i,u,s),t.findNext(v,e))}};return v}}));var t={display:function(n,r,o){if(o)r.style.display=o;else if("toggle"===n)"none"===getComputedStyle(r).display?t.display("show",r,o):t.display("hide",r,o);else if("hide"===n){const t=e.internals.runtime.getInternalData(r);null==t.originalDisplay&&(t.originalDisplay=r.style.display),r.style.display="none"}else{const t=e.internals.runtime.getInternalData(r);t.originalDisplay&&"none"!==t.originalDisplay?r.style.display=t.originalDisplay:r.style.removeProperty("display")}},visibility:function(e,n,r){r?n.style.visibility=r:"toggle"===e?"hidden"===getComputedStyle(n).visibility?t.visibility("show",n,r):t.visibility("hide",n,r):n.style.visibility="hide"===e?"hidden":"visible"},opacity:function(e,n,r){r?n.style.opacity=r:"toggle"===e?"0"===getComputedStyle(n).opacity?t.opacity("show",n,r):t.opacity("hide",n,r):n.style.opacity="hide"===e?"0":"1"}},n=function(e,t,n){var r=n.currentToken();return"when"===r.value||"with"===r.value||e.commandBoundary(r)?e.parseElement("implicitMeTarget",n):e.parseElement("expression",n)},r=function(n,r,a){var i=e.config.defaultHideShowStrategy,u=t;e.config.hideShowStrategies&&(u=o(u,e.config.hideShowStrategies));var s=u[a=a||i||"display"];return null==s&&n.raiseParseError(r,"Unknown show/hide strategy : "+a),s};function a(t,n,r,o){if(null!=r)var a=t.resolveSymbol(r,n);else a=n;if(a instanceof Element||a instanceof HTMLDocument){for(;a.firstChild;)a.removeChild(a.firstChild);a.append(e.internals.runtime.convertValue(o,"Fragment"))}else{if(null==r)throw"Don't know how to put a value into "+typeof n;t.setSymbol(r,n,null,o)}}function i(e,t,n){var r;if(n.matchToken("the")||n.matchToken("element")||n.matchToken("elements")||"CLASS_REF"===n.currentToken().type||"ID_REF"===n.currentToken().type||n.currentToken().op&&"<"===n.currentToken().value){e.possessivesDisabled=!0;try{r=e.parseElement("expression",n)}finally{delete e.possessivesDisabled}n.matchOpToken("'")&&n.requireToken("s")}else if("IDENTIFIER"===n.currentToken().type&&"its"===n.currentToken().value){var o=n.matchToken("its");r={type:"pseudopossessiveIts",token:o,name:o.value,evaluate:function(e){return t.resolveSymbol("it",e)}}}else n.matchToken("my")||n.matchToken("me"),r=e.parseElement("implicitMeTarget",n);return r}e.addCommand("hide",(function(e,t,o){if(o.matchToken("hide")){var a=n(e,0,o),i=null;o.matchToken("with")&&0===(i=o.requireTokenType("IDENTIFIER","STYLE_REF").value).indexOf("*")&&(i=i.substr(1));var u=r(e,o,i);return{target:a,args:[a],op:function(e,n){return t.nullCheck(n,a),t.implicitLoop(n,(function(e){u("hide",e)})),t.findNext(this,e)}}}})),e.addCommand("show",(function(e,t,o){if(o.matchToken("show")){var a=n(e,0,o),i=null;o.matchToken("with")&&0===(i=o.requireTokenType("IDENTIFIER","STYLE_REF").value).indexOf("*")&&(i=i.substr(1));var u=null;if(o.matchOpToken(":")){var s=o.consumeUntilWhitespace();o.matchTokenType("WHITESPACE"),u=s.map((function(e){return e.value})).join("")}if(o.matchToken("when"))var l=e.requireElement("expression",o);var c=r(e,o,i);return{target:a,when:l,args:[a],op:function(e,n){return t.nullCheck(n,a),t.implicitLoop(n,(function(n){l?(e.result=n,t.evaluateNoPromise(l,e)?c("show",n,u):c("hide",n),e.result=null):c("show",n,u)})),t.findNext(this,e)}}}})),e.addCommand("take",(function(e,t,n){if(n.matchToken("take")){var r=e.requireElement("classRef",n);if(n.matchToken("from"))var o=e.requireElement("expression",n);else o=r;if(n.matchToken("for"))var a=e.requireElement("expression",n);else a=e.requireElement("implicitMeTarget",n);return{classRef:r,from:o,forElt:a,args:[r,o,a],op:function(e,n,r,i){t.nullCheck(r,o),t.nullCheck(i,a);var u=n.className;return t.implicitLoop(r,(function(e){e.classList.remove(u)})),t.implicitLoop(i,(function(e){e.classList.add(u)})),t.findNext(this,e)}}}})),e.addCommand("put",(function(e,t,n){if(n.matchToken("put")){var r=e.requireElement("expression",n),o=n.matchAnyToken("into","before","after");null==o&&n.matchToken("at")&&(n.matchToken("the"),o=n.matchAnyToken("start","end"),n.requireToken("of")),null==o&&e.raiseParseError(n,"Expected one of 'into', 'before', 'at start of', 'at end of', 'after'");var i=e.requireElement("expression",n),u=o.value,s=!1,l=!1,c=null,f=null;if("arrayIndex"===i.type&&"into"===u)s=!0,f=i.prop,c=i.root;else if(i.prop&&i.root&&"into"===u)f=i.prop.value,c=i.root;else if("symbol"===i.type&&"into"===u)l=!0,f=i.name;else if("attributeRef"===i.type&&"into"===u){var m=!0;f=i.name,c=e.requireElement("implicitMeTarget",n)}else if("styleRef"===i.type&&"into"===u){var p=!0;f=i.name,c=e.requireElement("implicitMeTarget",n)}else i.attribute&&"into"===u?(m="attributeRef"===i.attribute.type,p="styleRef"===i.attribute.type,f=i.attribute.name,c=i.root):c=i;var d={target:i,operation:u,symbolWrite:l,value:r,args:[c,f,r],op:function(e,n,r,o){if(l)a(t,e,r,o);else if(t.nullCheck(n,c),"into"===u)m?t.implicitLoop(n,(function(e){e.setAttribute(r,o)})):p?t.implicitLoop(n,(function(e){e.style[r]=o})):s?n[r]=o:t.implicitLoop(n,(function(e){a(t,e,r,o)}));else{var i="before"===u?Element.prototype.before:"after"===u?Element.prototype.after:"start"===u?Element.prototype.prepend:Element.prototype.append;t.implicitLoop(n,(function(e){i.call(e,o instanceof Node?o:t.convertValue(o,"Fragment"))}))}return t.findNext(this,e)}};return d}})),e.addCommand("transition",(function(t,n,r){if(r.matchToken("transition")){for(var o=i(t,n,r),a=[],u=[],s=[],l=r.currentToken();!t.commandBoundary(l)&&"over"!==l.value&&"using"!==l.value;){if("STYLE_REF"===r.currentToken().type){let e=r.consumeToken().value.substr(1);a.push({type:"styleRefValue",evaluate:function(){return e}})}else a.push(t.requireElement("stringLike",r));r.matchToken("from")?u.push(t.requireElement("expression",r)):u.push(null),r.requireToken("to"),r.matchToken("initial")?s.push({type:"initial_literal",evaluate:function(){return"initial"}}):s.push(t.requireElement("expression",r)),l=r.currentToken()}if(r.matchToken("over"))var c=t.requireElement("expression",r);else if(r.matchToken("using"))var f=t.requireElement("expression",r);var m={to:s,args:[o,a,u,s,f,c],op:function(t,r,a,i,u,s,l){n.nullCheck(r,o);var c=[];return n.implicitLoop(r,(function(t){var r=new Promise((function(r,o){var c=t.style.transition;t.style.transition=l?"all "+l+"ms ease-in":s||e.config.defaultTransition;for(var f=n.getInternalData(t),m=getComputedStyle(t),p={},d=0;d<m.length;d++){var h=m[d];p[h]=m[h]}for(f.initalStyles||(f.initalStyles=p),d=0;d<a.length;d++){var v=a[d],E=i[d];t.style[v]="computed"===E||null==E?p[v]:E}var T=!1,y=!1;t.addEventListener("transitionend",(function(){y||(t.style.transition=c,y=!0,r())}),{once:!0}),t.addEventListener("transitionstart",(function(){T=!0}),{once:!0}),setTimeout((function(){y||T||(t.style.transition=c,y=!0,r())}),100),setTimeout((function(){for(var e=0;e<a.length;e++){var n=a[e],r=u[e];t.style[n]="initial"===r?f.initalStyles[n]:r}}),0)}));c.push(r)})),Promise.all(c).then((function(){return n.findNext(m,t)}))}};return m}})),e.addCommand("measure",(function(e,t,n){if(n.matchToken("measure")){var r=i(e,t,n),o=[];if(!e.commandBoundary(n.currentToken()))do{o.push(n.matchTokenType("IDENTIFIER").value)}while(n.matchOpToken(","));return{properties:o,args:[r],op:function(e,n){t.nullCheck(n,r),0 in n&&(n=n[0]);var a=n.getBoundingClientRect(),i={top:n.scrollTop,left:n.scrollLeft,topMax:n.scrollTopMax,leftMax:n.scrollLeftMax,height:n.scrollHeight,width:n.scrollWidth};return e.result={x:a.x,y:a.y,left:a.left,top:a.top,right:a.right,bottom:a.bottom,width:a.width,height:a.height,bounds:a,scrollLeft:i.left,scrollTop:i.top,scrollLeftMax:i.leftMax,scrollTopMax:i.topMax,scrollWidth:i.width,scrollHeight:i.height,scroll:i},t.forEach(o,(function(t){if(!(t in e.result))throw"No such measurement as "+t;e[t]=e.result[t]})),t.findNext(this,e)}}}})),e.addLeafExpression("closestExpr",(function(e,t,n){if(n.matchToken("closest")){if(n.matchToken("parent"))var r=!0;var o=null;if("ATTRIBUTE_REF"===n.currentToken().type){var a=e.requireElement("attributeRefAccess",n,null);o="["+a.attribute.name+"]"}if(null==o){var i=e.requireElement("expression",n);null==i.css?e.raiseParseError(n,"Expected a CSS expression"):o=i.css}if(n.matchToken("to"))var u=e.parseElement("expression",n);else u=e.parseElement("implicitMeTarget",n);var s={type:"closestExpr",parentSearch:r,expr:i,css:o,to:u,args:[u],op:function(e,n){if(null==n)return null;{let e=[];return t.implicitLoop(n,(function(t){e.push(r?t.parentElement?t.parentElement.closest(o):null:t.closest(o))})),t.shouldAutoIterate(n)?e:e[0]}},evaluate:function(e){return t.unifiedEval(this,e)}};return a?(a.root=s,a.args=[s],a):s}})),e.addCommand("go",(function(e,t,n){if(n.matchToken("go")){if(n.matchToken("back"))var r=!0;else if(n.matchToken("to"),n.matchToken("url")){var o=e.requireElement("stringLike",n),a=!0;if(n.matchToken("in")){n.requireToken("new"),n.requireToken("window");var i=!0}}else{n.matchToken("the");var u=n.matchAnyToken("top","middle","bottom"),s=n.matchAnyToken("left","center","right");(u||s)&&n.requireToken("of"),o=e.requireElement("unaryExpression",n);var l=n.matchAnyOpToken("+","-");if(l){n.pushFollow("px");try{var c=e.requireElement("expression",n)}finally{n.popFollow()}}n.matchToken("px");var f=n.matchAnyToken("smoothly","instantly"),m={};u&&("top"===u.value?m.block="start":"bottom"===u.value?m.block="end":"middle"===u.value&&(m.block="center")),s&&("left"===s.value?m.inline="start":"center"===s.value?m.inline="center":"right"===s.value&&(m.inline="end")),f&&("smoothly"===f.value?m.behavior="smooth":"instantly"===f.value&&(m.behavior="instant"))}var p={target:o,args:[o,c],op:function(e,n,o){return r?window.history.back():a?n&&(i?window.open(n):window.location.href=n):t.implicitLoop(n,(function(e){if(e===window&&(e=document.body),l){var t=e.getBoundingClientRect();let r=document.createElement("div");if("-"===l.value)var n=-o;else n=o;r.style.position="absolute",r.style.top=t.x+n+"px",r.style.left=t.y+n+"px",r.style.height=t.height+2*n+"px",r.style.width=t.width+2*n+"px",r.style.zIndex=""+Number.MIN_SAFE_INTEGER,r.style.opacity="0",document.body.appendChild(r),setTimeout((function(){document.body.removeChild(r)}),100),e=r}e.scrollIntoView(m)})),t.findNext(p,e)}};return p}})),e.config.conversions.dynamicResolvers.push((function(t,n){if("Values"===t||0===t.indexOf("Values:")){var r=t.split(":")[1],o={};if((0,e.internals.runtime.implicitLoop)(n,(function(e){var t=i(e);void 0===t?null!=e.querySelectorAll&&e.querySelectorAll("input,select,textarea").forEach(a):o[t.name]=t.value})),r){if("JSON"===r)return JSON.stringify(o);if("Form"===r)return new URLSearchParams(o).toString();throw"Unknown conversion: "+r}return o}function a(e){var t=i(e);null!=t&&(null!=o[t.name]?Array.isArray(o[t.name])&&Array.isArray(t.value)&&(o[t.name]=[].concat(o[t.name],t.value)):o[t.name]=t.value)}function i(e){try{var t={name:e.name,value:e.value};if(null==t.name||null==t.value)return;if("radio"==e.type&&0==e.checked)return;if("checkbox"==e.type&&(0==e.checked?t.value=void 0:"string"==typeof t.value&&(t.value=[t.value])),"select-multiple"==e.type){var n=e.querySelectorAll("option[selected]");t.value=[];for(var r=0;r<n.length;r++)t.value.push(n[r].value)}return t}catch(e){return}}})),e.config.conversions.HTML=function(e){return function e(t){if(t instanceof Array)return t.map((function(t){return e(t)})).join("");if(t instanceof HTMLElement)return t.outerHTML;if(t instanceof NodeList){for(var n="",r=0;r<t.length;r++){var o=t[r];o instanceof HTMLElement&&(n+=o.outerHTML)}return n}return t.toString?t.toString():""}(e)},e.config.conversions.Fragment=function(t){var n=document.createDocumentFragment();return e.internals.runtime.implicitLoop(t,(function(e){if(e instanceof Node)n.append(e);else{var t=document.createElement("template");t.innerHTML=e,n.append(t.content)}})),n}})(x)}}]);
//# sourceMappingURL=npm.hyperscript.org.3501da42.js.map